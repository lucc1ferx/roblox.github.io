!function(){"use strict";var e={n:function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,{a:r}),r},d:function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=React,r=e.n(t),n=ReactDOM,a=CoreUtilities,i=PropTypes,s=e.n(i),o=ReactUtilities,l=ReactStyleGuide,c={purchasingResources:{common:[],feature:"Purchasing.PurchaseDialog"},itemResources:{common:[],feature:"Feature.Item"},itemModelResources:{common:[],feature:"Feature.ItemModel"}},u={transactionFailure:"TransactionFailureView",insufficientFunds:"InsufficientFundsView",priceChanged:"PriceChangedView"},d={badRequest:"Bad Request"},m={startItemPurchase:"ItemPurchaseStart",NEW_UPSELL_FAILED_DUE_TO_ERROR:"ReactBuyButtonNewUpsellProcessFailedDueToError",NEW_UPSELL_FAILED_DUE_TO_LOADING:"ReactBuyButtonNewUpsellProcessFailedDueToNotLoaded",NEW_UPSELL_FROM_REACT_BUY_BUTTON:"ReactBuyButtonNewUpsellProcessNewUpsellFromReactBuyButton"},p={freeLabel:"Label.Free",okAction:"Action.Ok",insufficientFundsHeading:"Heading.InsufficientFunds",insufficientFundsMessage:"Message.InsufficientFunds",doneAction:"Action.Done",cancelAction:"Action.Cancel",buyRobuxAction:"Action.BuyRobux",buyAccessAction:"Action.BuyAccess",buyItemHeading:"Heading.BuyItem",buyNowAction:"Action.BuyNow",getItemHeading:"Heading.GetItem",getNowAction:"Action.GetNow",priceChangedHeading:"Heading.PriceChanged",priceChangedMessage:"Message.PriceChanged",balanceAfterMessage:"Message.BalanceAfter",agreeAndPayLabel:"Label.AgreeAndPay",promptGetFreeAccessMessage:"Message.PromptGetFreeAccess",promptGetFreeMessage:"Message.PromptGetFree",promptBuyAccessMessage:"Message.PromptBuyAccess",promptBuyMessage:"Message.PromptBuy",configureAction:"Action.Customize",notNowAction:"Action.NotNow",customizeAction:"Action.Customize",continueAction:"Action.Continue",purchaseCompleteHeading:"Heading.PurchaseComplete",successfullyBoughtAccessMessage:"Message.SuccessfullyBoughtAccess",successfullyBoughtMessage:"Message.SuccessfullyBought",successfullyRenewedAccessMessage:"Message.SuccessfullyRenewedAccess",successfullyRenewedMessage:"Message.SuccessfullyRenewed",successfullyAcquiredAccessMessage:"Message.SuccessfullyAcquiredAccess",successfullyAcquiredMessage:"Message.SuccessfullyAcquired",itemGrantDelayMessage:"Message.ItemGrantDelay",errorOccuredHeading:"Heading.ErrorOccured",purchasingUnavailableMessage:"Message.PurchasingUnavailable",buyAction:"Action.Buy",installAction:"Action.Install",getAction:"Action.Get",bestPriceLabel:"Label.BestPrice",priceLabel:"Label.Price",premiumDiscountOpportunityPromptLabel:"Label.PremiumDiscountOpportunityPrompt",premiumDiscountSavingsLabel:"Label.PremiumDiscountSavings",premiumExclusiveEligiblePromptLabel:"Label.PremiumExclusiveEligiblePrompt",premiumExclusiveIneligiblePromptLabel:"Label.PremiumExclusiveIneligiblePrompt",getPremiumAction:"Action.GetPremium",itemNotCurrentlyForSaleLabel:"Label.ItemNotCurrentlyForSale",itemNoLongerForSaleLabel:"Label.ItemNoLongerForSale",purchasingTemporarilyUnavailableLabel:"Label.PurchasingTemporarilyUnavailable",itemAvailableInventoryLabel:"Label.ItemAvailableInventory",noOneCurrentlySellingLabel:"Label.NoOneCurrentlySelling",inventoryAction:"Action.Inventory",OffsaleCountdownHourMinuteSecondLabel:"Label.OffsaleCountdownHourMinuteSecond",CountdownTimerDayHourMinute:"Label.CountdownTimerDayHourMinute",batchBuyItemHeading:"Heading.BuyItems",batchBuyPromptMessage:"Message.PromptBatchBuy",batchBuyBalanceAfterMessage:"Message.BalanceAfter",purchaseCompletedMessage:"Heading.PurchaseCompleted",generalPurchaseErrorMessage:"Heading.GeneralError",batchBuyPartialSuccessGeneralFailureMessage:"Heading.PartialSuccessGeneralFailure",batchBuyPartialSuccessItemsOwnedFailureMessage:"Heading.PartialSuccessItemsOwnedFailure",batchBuyPartialSuccessInsufficientFundsFailureMessage:"Heading.PartialSuccessInsufficientFundsFailure",batchBuyPartialSuccessNetworkErrorFailureMessage:"Heading.PartialSuccessNetworkErrorFailure",batchBuyPartialSuccessFloodcheckFailureMessage:"Heading.PartialSuccessFloodcheckFailure",purchaseErrorFailureMessage:"Heading.PurchaseFailure",batchBuyItemsOwnedFailureMessage:"Heading.ItemsOwnedFailure",insufficientFundsFailureMessage:"Heading.InsufficientFundsFailure",networkErrroFailureMessage:"Heading.NetworkErrorFailure",floodcheckFailureMessage:"Heading.FloodcheckFailure",batchBuyPartialSuccessPremiumNeededFailureMessage:"Heading.PartialSuccessPremiumNeededFailure",batchBuyPartialSuccessNoSellersFailureMessage:"Heading.PartialSuccessNoSellersFailure",premiumNeededFailureMessage:"Heading.PremiumNeededFailure",noSellersFailureMessage:"Heading.NoSellersFailure"},f={Plugin:38,Decal:13,Model:10,Video:62,MeshPart:40,Place:9,Badge:21,GamePass:34,Animation:24},b={Catalog:0,Library:1},y={insufficientFunds:"InsufficientFunds",retryErrorMessage:"Failed to determine purchasability status. Please try again by refreshing.",notForSale:"NotForSale",unauthorizedMessage:"Unauthorized"},g=3,h=5,v=5;function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var P=p;function w(){var e=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,l.createModal)(),2),t=e[0];e=e[1];function n(e){var n=e.translate,a=e.title,i=e.message;e=e.onDecline,i=r().createElement("div",{className:"modal-message"},i);return r().createElement(t,{title:a,body:i,thumbnail:r().createElement("span",{className:"icon-warning-orange-150x150"}),neutralButtonText:n(P.okAction),onNeutral:e})}return n.defaultProps={onDecline:null},n.propTypes={translate:s().func.isRequired,title:s().string.isRequired,message:s().string.isRequired,onDecline:s().func},[(0,o.withTranslations)(n,c.purchasingResources),e]}var I=ReactDOMServer,A=CoreRobloxUtilities,E=Roblox,T=E.EnvironmentUrls.economyApi,R=E.EnvironmentUrls.catalogApi,x=E.EnvironmentUrls.apiGatewayUrl,M=E.EnvironmentUrls.twoStepVerificationApi,N={getRobuxUpgradesUrl:function(e){return a.urlService.getUrlWithQueries("/Upgrades/Robux.aspx",{ctx:e})},getAvatarPageUrl:function(){return a.urlService.getAbsoluteUrl("/my/avatar")},getPurchaseItemUrl:function(e){return T+"/v1/purchases/products/"+e},getItemDetailsUrl:function(e,t){return R+"/v1/catalog/items/"+e+"/details?itemType="+t},postItemDetailsUrl:function(){return R+"/v1/catalog/items/details"},getPurchaseableDetailUrl:function(e){return T+"/v1/products/"+e+"?showPurchasable=true"},getPremiumConversionUrl:function(e,t){return"/premium/membership?ctx=WebItemDetail&upsellTargetType="+t+"&upsellTargetId="+e},getResellerDataUrl:function(e){return T+"/v1/assets/"+e+"/resellers?limit=10"},getInventoryUrl:function(e){return"/users/"+e+"/inventory"},getMetaDataUrl:function(){return T+"/v2/metadata"},getCurrentUserBalance:function(e){return T+"/v1/users/"+e+"/currency"},getPurchaseCollectibleItemUrl:function(e){return x+"/marketplace-sales/v1/item/"+e+"/purchase-item"},getPurchaseCollectibleItemInstanceUrl:function(e){return x+"/marketplace-sales/v1/item/"+e+"/purchase-resale"},getCollectibleItemDetailsUrl:function(){return x+"/marketplace-items/v1/items/details"},getTwoStepVerificationConfig:function(e){return M+"/v1/users/"+e+"/configuration"},postGenerateTwoStepVerificationToken:function(e){return T+"/v2/"+e+"/two-step-verification/generate"},postRedeemTwoStepVerificationChallenge:function(e){return T+"/v2/"+e+"/two-step-verification/redeem"}},C=p;function F(e){var t=e.translate,n=e.price;e=e.color;return 0===n?r().createElement("span",{className:"text-robux text-free"},t(C.freeLabel)):r().createElement(r().Fragment,null,r().createElement("span",{className:"icon-robux".concat(e?"-".concat(e):"","-16x16")}),r().createElement("span",{className:"text-robux"},a.numberFormat.getNumberFormat(n)))}F.defaultProps={color:""},F.propTypes={price:s().number.isRequired,translate:s().func.isRequired,color:s().string};var D=(0,o.withTranslations)(F,c.purchasingResources);function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var q=p;function B(){var e=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return U(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?U(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,l.createModal)(),2),t=e[0];e=e[1];function n(e){var n=e.translate,a=e.robuxNeeded,i=e.source;a=r().createElement("div",{className:"modal-message",dangerouslySetInnerHTML:{__html:n(q.insufficientFundsMessage,{robux:(0,I.renderToString)(r().createElement(D,{price:a}))})}});return r().createElement(t,O({title:n(q.insufficientFundsHeading),body:a,thumbnail:r().createElement("span",{className:"money-stack-icon"}),neutralButtonText:n(q.cancelAction),actionButtonText:n(q.buyRobuxAction),onAction:function(){return A.paymentFlowAnalyticsService.sendUserPurchaseFlowEvent(A.paymentFlowAnalyticsService.ENUM_TRIGGERING_CONTEXT.WEB_CATALOG_ROBUX_UPSELL,!0,A.paymentFlowAnalyticsService.ENUM_VIEW_NAME.ROBUX_UPSELL,A.paymentFlowAnalyticsService.ENUM_PURCHASE_EVENT_TYPE.USER_INPUT,A.paymentFlowAnalyticsService.ENUM_VIEW_MESSAGE.BUY_ROBUX),window.location=N.getRobuxUpgradesUrl(i),!1},onClose:function(){A.paymentFlowAnalyticsService.sendUserPurchaseFlowEvent(A.paymentFlowAnalyticsService.ENUM_TRIGGERING_CONTEXT.WEB_CATALOG_ROBUX_UPSELL,!0,A.paymentFlowAnalyticsService.ENUM_VIEW_NAME.ROBUX_UPSELL,A.paymentFlowAnalyticsService.ENUM_PURCHASE_EVENT_TYPE.USER_INPUT,A.paymentFlowAnalyticsService.ENUM_VIEW_MESSAGE.CANCEL)}},{actionButtonShow:!0}))}return n.defaultProps={onAccept:null,source:""},n.propTypes={translate:s().func.isRequired,source:s().string,onAccept:s().func,robuxNeeded:s().number.isRequired},[(0,o.withTranslations)(n,c.purchasingResources),e]}function L(){var e=document.getElementById("ItemPurchaseAjaxData");return e?{userRobuxBalance:parseInt(e.getAttribute("data-user-balance-robux"),10),userBc:parseInt(e.getAttribute("data-user-bc"),10),hasCurrencyServiceError:"True"===e.getAttribute("data-has-currency-service-error"),currencyServiceErrorMessage:e.getAttribute("data-currency-service-error-message")}:{}}var k=p;function _(e){var t=e.translate,n=e.expectedPrice;n=(null!=(e=e.currentRobuxBalance)?e:L().userRobuxBalance)-n;return r().createElement("span",{dangerouslySetInnerHTML:{__html:t(k.balanceAfterMessage,{robuxBalance:(0,I.renderToString)(r().createElement(D,{price:n,color:"gray"}))})}})}_.propTypes={expectedPrice:s().number.isRequired,currentRobuxBalance:s().number,translate:s().func.isRequired},_.defaultProps={currentRobuxBalance:void 0};var j=(0,o.withTranslations)(_,c.purchasingResources);function H(){return(H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?G(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var W=p;function z(){var e=(n=V((0,l.createModal)(),2))[0],n=n[1];function a(n){var a=n.translate,i=n.expectedPrice,s=n.currentPrice,o=n.onAction,l=n.loading,c=(n=V((0,t.useState)(!1),2))[0],u=n[1];i=r().createElement(r().Fragment,null,r().createElement("div",{className:"modal-message",dangerouslySetInnerHTML:{__html:a(W.priceChangedMessage,{robuxBefore:(0,I.renderToString)(r().createElement(D,{price:i,color:"gray"})),robuxAfter:(0,I.renderToString)(r().createElement(D,{price:s,color:"gray"}))})}}),r().createElement("div",{className:"modal-checkbox checkbox"},r().createElement("input",{id:"modal-checkbox-input",name:"agreementCheckBox",type:"checkbox",checked:c}),r().createElement("label",{onClick:function(){return u(!c)},htmlFor:"modal-checkbox-input"},a(W.agreeAndPayLabel))));return r().createElement(e,H({title:a(W.priceChangedHeading),body:i,neutralButtonText:a(W.cancelAction),actionButtonText:a(W.buyRobuxAction),onAction:o,loading:l,disableActionButton:!c,footerText:r().createElement(j,{expectedPrice:s})},{actionButtonShow:!0}))}return a.defaultProps={loading:!1},a.propTypes={translate:s().func.isRequired,expectedPrice:s().number.isRequired,currentPrice:s().number.isRequired,onAction:s().func.isRequired,loading:s().bool},[(0,o.withTranslations)(a,c.purchasingResources),n]}function $(e){return e=e.name,r().createElement("span",{className:"font-bold"},e)}$.propTypes={name:s().string.isRequired};var X=$;function Q(){return(Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var J=p;function K(){var e=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Y(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,l.createModal)(),2),t=e[0];e=e[1];function n(e){var n,a=e.translate,i=e.title,s=e.expectedPrice,o=e.thumbnail,l=e.assetName,c=e.assetType,u=e.assetTypeDisplayName,d=e.sellerName,m=e.isPlace,p=e.onAction;e=e.loading,u={assetName:(0,I.renderToString)(r().createElement(X,{name:l})),assetType:u||c,seller:d,robux:(0,I.renderToString)(r().createElement(D,{price:s}))},c=m?J.promptBuyAccessMessage:J.promptBuyMessage,d=0===s?(n=a(J.getItemHeading),a(J.getNowAction)):(n=a(J.buyItemHeading),a(J.buyNowAction));return m&&(d=a(J.buyAccessAction)),u=r().createElement("div",{className:"modal-message",dangerouslySetInnerHTML:{__html:a(c,u)}}),r().createElement(t,Q({title:i||n,body:u,thumbnail:o,neutralButtonText:a(J.cancelAction),actionButtonText:d,onAction:p,footerText:r().createElement(j,{expectedPrice:s}),loading:e},{actionButtonShow:!0}))}return n.defaultProps={isPlace:!1,assetTypeDisplayName:"",title:"",loading:!1},n.propTypes={translate:s().func.isRequired,title:s().string,expectedPrice:s().number.isRequired,thumbnail:s().node.isRequired,assetName:s().string.isRequired,assetType:s().string.isRequired,assetTypeDisplayName:s().string,sellerName:s().string.isRequired,isPlace:s().bool,onAction:s().func.isRequired,loading:s().bool},[(0,o.withTranslations)(n,c.purchasingResources),e]}(Tt=Rt=Rt||{}).Bought="bought",Tt.Renewed="renewed";var Z=Rt;function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var te=N.getAvatarPageUrl,re=p;function ne(){var e=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ee(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,l.createModal)(),2),t=e[0];e=e[1];function n(e){var n,a,i=e.translate,s=e.expectedPrice,o=e.thumbnail,l=e.assetName,c=e.assetType,u=e.assetIsWearable,d=e.assetTypeDisplayName,m=e.sellerName,p=e.isPlace,f=e.isPrivateServer,b=e.onAccept,y=e.onDecline,g=e.transactionVerb,h=e.itemDelayed;e=i(re.continueAction);return f?(n=i(re.configureAction),e=i(re.notNowAction)):h?(n=i(re.customizeAction),e=i(re.doneAction)):u&&(n=i(re.customizeAction),e=i(re.notNowAction),a=function(){return window.location.href=te(),!1}),m={assetName:(0,I.renderToString)(r().createElement(X,{name:l})),assetType:d||c,seller:m,robux:(0,I.renderToString)(r().createElement(D,{price:s}))},p=g===Z.Bought?p?re.successfullyAcquiredAccessMessage:re.successfullyBoughtMessage:g===Z.Renewed?p?re.successfullyRenewedAccessMessage:re.successfullyRenewedMessage:p?re.successfullyAcquiredAccessMessage:re.successfullyAcquiredMessage,m=r().createElement("div",{className:"modal-message",dangerouslySetInnerHTML:{__html:"".concat(i(p,m)," ").concat(h?i(re.itemGrantDelayMessage):"")}}),r().createElement(t,{title:i(re.purchaseCompleteHeading),body:m,thumbnail:o,neutralButtonText:e,actionButtonText:n,onAction:b||a,onNeutral:y,footerText:!f&&r().createElement(j,{expectedPrice:s}),actionButtonShow:!!n,disableActionButton:h,onClose:function(){return window.location.reload()}})}return n.defaultProps={isPlace:!1,assetTypeDisplayName:"",transactionVerb:"",assetIsWearable:!1,isPrivateServer:!1,onAccept:null,onDecline:null,itemDelayed:!1},n.propTypes={translate:s().func.isRequired,transactionVerb:s().string,expectedPrice:s().number.isRequired,thumbnail:s().node.isRequired,assetName:s().string.isRequired,assetType:s().string.isRequired,assetTypeDisplayName:s().string,assetIsWearable:s().bool,sellerName:s().string.isRequired,isPlace:s().bool,isPrivateServer:s().bool,onAccept:s().func,onDecline:s().func,itemDelayed:s().bool},[(0,o.withTranslations)(n,c.purchasingResources),e]}var ae=N.getPurchaseItemUrl,ie=N.getPurchaseCollectibleItemUrl,se=N.getPurchaseCollectibleItemInstanceUrl,oe={purchaseCollectibleItem:function(e,t){return e={url:ie(e),retryable:!0,withCredentials:!0},a.httpService.post(e,t)},purchaseCollectibleItemInstance:function(e,t){return e={url:se(e),retryable:!0,withCredentials:!0},a.httpService.post(e,t)},purchaseItem:function(e,t){return e={url:ae(e),retryable:!0,withCredentials:!0},a.httpService.post(e,t)}},le=function(e,t,r,n){return new(r=r||Promise)((function(a,i){function s(e){try{l(n.next(e))}catch(e){i(e)}}function o(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):((t=e.value)instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((n=n.apply(e,t||[])).next())}))},ce=function(e,t){var r,n,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},s={next:o(0),throw:o(1),return:o(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=0<(a=i.trys).length&&a[a.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},ue=N.getTwoStepVerificationConfig,de=N.postGenerateTwoStepVerificationToken,me=N.postRedeemTwoStepVerificationChallenge,pe=function(e,t){return le(void 0,void 0,Promise,(function(){var r,n;return ce(this,(function(i){switch(i.label){case 0:r={url:me("spend-friction"),retryable:!0,withCredentials:!0},n={challengeToken:e,verificationToken:t},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,a.httpService.post(r,n)];case 2:return[2,null!==(n=(n=i.sent()).data)&&void 0!==n&&n];case 3:return i.sent(),[2,!1];case 4:return[2]}}))}))},fe=function(e,t,r,n){return new(r=r||Promise)((function(a,i){function s(e){try{l(n.next(e))}catch(e){i(e)}}function o(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):((t=e.value)instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((n=n.apply(e,t||[])).next())}))},be=function(e,t){var r,n,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},s={next:o(0),throw:o(1),return:o(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(a=2&s[0]?n.return:s[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,s[1])).done)return a;switch(n=0,a&&(s=[2&s[0],a.value]),s[0]){case 0:case 1:a=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(a=0<(a=i.trys).length&&a[a.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!a||s[1]>a[0]&&s[1]<a[3])){i.label=s[1];break}if(6===s[0]&&i.label<a[1]){i.label=a[1],a=s;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(s);break}a[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=a=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},ye=E.AccountIntegrityChallengeService.TwoStepVerification;function ge(e){var t=e.systemFeedbackService;e=e.translate;t.warning(e("Response.VerificationError"))}function he(e){var t=e.stopTwoStepVerification,r=e.systemFeedbackService,n=e.totalAttempts,i=e.translate;return fe(this,void 0,void 0,(function(){var e,s=this;return be(this,(function(o){switch(o.label){case 0:return[4,le(void 0,void 0,Promise,(function(){var e;return ce(this,(function(t){switch(t.label){case 0:e={url:de("spend-friction"),retryable:!0,withCredentials:!0},t.label=1;case 1:return t.trys.push([1,3,,4]),[4,a.httpService.post(e)];case 2:return[2,t.sent().data||null];case 3:return t.sent(),[2,null];case 4:return[2]}}))}))];case 1:return(e=o.sent())?E.AccountIntegrityChallengeService.TwoStepVerification.renderChallenge({containerId:"two-sv-popup-entry",userId:E.CurrentUser.userId,challengeId:e,actionType:ye.ActionType.RobuxSpend,renderInline:!1,shouldShowRememberDeviceCheckbox:!1,shouldDynamicallyLoadTranslationResources:!1,onChallengeCompleted:function(n){return fe(s,void 0,void 0,(function(){var a;return be(this,(function(s){switch(s.label){case 0:return[4,pe(e,n.verificationToken)];case 1:return a=s.sent(),t(),a?(l=(o={systemFeedbackService:r,translate:i}).systemFeedbackService,o=o.translate,l.success(o("Response.SuccessfulVerificationV2"))):ge({systemFeedbackService:r,translate:i}),[2]}var o,l}))}))},onChallengeInvalidated:function(){var e=n||0;e<3?he({stopTwoStepVerification:t,systemFeedbackService:r,translate:i,totalAttempts:e+1}):(ge({systemFeedbackService:r,translate:i}),t())},onModalChallengeAbandoned:function(){}}):ge({systemFeedbackService:r,translate:i}),[2]}}))}))}var ve=(0,o.withTranslations)((function(e){var n=this,i=e.translate,s=e.isTwoStepVerificationActive,o=e.stopTwoStepVerification,l=e.systemFeedbackService;return(0,t.useEffect)((function(){s&&fe(n,void 0,void 0,(function(){return be(this,(function(e){switch(e.label){case 0:return[4,le(void 0,void 0,Promise,(function(){var e;return ce(this,(function(t){switch(t.label){case 0:e={url:ue(E.CurrentUser.userId),retryable:!0,withCredentials:!0},t.label=1;case 1:return t.trys.push([1,3,,4]),[4,a.httpService.get(e)];case 2:return[2,((null===(e=null==(e=t.sent())?void 0:e.data)||void 0===e?void 0:e.methods)||[]).some((function(e){return!!e.enabled}))];case 3:return t.sent(),[2,!1];case 4:return[2]}}))}))];case 1:return e.sent()?he({stopTwoStepVerification:o,systemFeedbackService:l,translate:i}):(t={titleText:(t=(t={translate:i}).translate)("Heading.TwoStepVerificationRequiredV3"),bodyContent:t("Message.TwoStepVerificationRequiredV4"),imageUrl:void 0,acceptText:t("Action.GoToSecurity"),acceptColor:"btn-primary-md",onAccept:function(){window.location.href=E.Endpoints.getAbsoluteUrl("/my/account#!/security")},declineText:t("Action.Cancel"),dismissable:!0,allowHtmlContentInBody:!0,onOpenCallback:function(){}},E.Dialog.open(t)),[2]}var t}))}))}),[s]),r().createElement("div",{id:"two-sv-popup-entry"})}),c.purchasingResources);function Se(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function Pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(r),!0).forEach((function(t){var n,a;n=e,t=r[a=t],a in n?Object.defineProperty(n,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[a]=t})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Se(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function we(e,t,r,n,a,i,s){try{var o=e[i](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function Ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ae(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ae(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ee=p,Te=u,Re=d,xe=m;function Me(){function e(){N.itemDetail.buyButtonElementDataset&&(A.paymentFlowAnalyticsService.startRobuxUpsellFlow(N.itemDetail.buyButtonElementDataset.assetType,!!N.itemDetail.buyButtonElementDataset.userassetId,N.itemDetail.buyButtonElementDataset.isPrivateServer,N.itemDetail.buyButtonElementDataset.isPlace),S.open())}function n(){var t,r,n;if(E.ItemPurchaseUpsellService&&null!==(t=N)&&void 0!==t&&null!==(r=t.itemDetail)&&void 0!==r&&r.expectedItemPrice)if(0<=m-(null==N||null===(n=N.itemDetail)||void 0===n?void 0:n.expectedItemPrice))e();else try{E.ItemPurchaseUpsellService.startItemUpsellProcess(N.errorObject,N.itemDetail,N.startOriginalFlowCallback),window.EventTracker.fireEvent(xe.NEW_UPSELL_FROM_REACT_BUY_BUTTON)}catch(t){window.EventTracker.fireEvent(xe.NEW_UPSELL_FAILED_DUE_TO_ERROR),e()}else window.EventTracker.fireEvent(xe.NEW_UPSELL_FAILED_DUE_TO_LOADING),e()}var i,u=(i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).customPurchaseVerificationModal,d=i.customPurchaseVerificationModalService,m=L().userRobuxBalance,p=(i=Ie((0,l.createSystemFeedback)(),2))[0],f=i[1],b=(i=Ie((0,l.createSystemFeedback)(),2))[0],y=i[1],g=(i=Ie(K(),2))[0],h=i[1],v=(i=Ie(B(),2))[0],S=i[1],P=(i=Ie(ne(),2))[0],I=i[1],T=(i=Ie(z(),2))[0],R=i[1],x=(i=Ie(w(),2))[0],M=i[1],N={errorObject:{},itemDetail:{},startOriginalFlowCallback:function(){return null}};function C(i){function s(){return ie(!0)}var o,l=i.translate,c=i.assetName,S=i.assetType,w=i.assetTypeDisplayName,A=i.productId,C=i.expectedCurrency,F=i.expectedPrice,D=i.expectedSellerId,O=i.expectedPromoId,U=i.userAssetId,q=i.thumbnail,B=i.sellerName,L=i.sellerType,k=i.showSuccessBanner,_=i.isPlace,j=i.isPrivateServer,H=i.handlePurchase,V=i.onPurchaseSuccess,G=i.collectibleItemId,W=i.collectibleItemInstanceId,z=i.collectibleProductId,$=i.customProps,X=(ee=Ie((0,t.useState)(!1),2))[0],Q=ee[1],Y=(o=Ie((0,t.useState)(null),2))[0],J=o[1],K=(re=Ie((0,t.useState)(null),2))[0],Z=re[1],ee=(i=Ie((0,t.useState)(F-m),2))[0],te=i[1],re=(o=Ie((0,t.useState)(null),2))[0],ne=o[1],ae=(i=Ie((0,t.useState)(!1),2))[0],ie=i[1],se=(i=(o=Ie((0,t.useState)(!1),2))[0],o[1]);function le(){(d||h).close(),R.close()}function ce(t,r){var n,a,i={assetType:S,assetTypeDisplayName:w,expectedCurrency:C,expectedPrice:r,expectedSellerId:D,itemName:c,itemType:S,productId:A,userassetId:U,placeproductpromotionId:O,isPrivateServer:j,isPlace:_};N={errorObject:{shortfallPrice:t,currentCurrency:C,isPlace:_},itemDetail:{expectedItemPrice:r,assetName:c,buyButtonElementDataset:i},startOriginalFlowCallback:(n=t,a=i,function(){E.ItemPurchaseUpsellService&&E.ItemPurchaseUpsellService.showExceedLargestInsufficientRobuxModal?E.ItemPurchaseUpsellService.showExceedLargestInsufficientRobuxModal(n,a,e):e()})}}function ue(e){var t=e.showDivId,r=e.title,a=e.errorMsg,i=e.price,s=e.shortfallPrice;e=e.onDecline;t===Te.transactionFailure?(J({title:r,message:a,onDecline:e}),M.open()):t===Te.insufficientFunds?(te(s),ce(s,i),n()):t===Te.priceChanged&&(Z(i),R.open())}function de(e){ne(e),I.open()}function me(e){G?pe(e):(e={expectedCurrency:C,expectedPrice:e,expectedSellerId:D},0<O&&(e.expectedPromoId=O),0<U&&(e.userAssetId=U),H?H({params:e,handleError:ue,setLoading:Q,openConfirmation:de,closeAll:le}):(Q(!0),oe.purchaseItem(A,e).then((function(e){var t=e.data;console.debug(t);var r=t.statusCode,n=t.assetIsWearable;e=t.transactionVerb;Q(!1),le(),t.purchased||"TwoStepVerificationRequired"!==t.reason?500===r?ue(t):(V(),k?f.success(l(Ee.purchaseCompleteHeading)):de({assetIsWearable:n,transactionVerb:e,onDecline:function(){window.location.reload()}})):s()})).catch((function(e){if(console.debug(e),Q(!1),le(),e&&(null==e?void 0:e.statusText)!==Re.badRequest){429===e.status&&ue({title:l(Ee.errorOccuredHeading),errorMsg:l(Ee.floodcheckFailureMessage,{throttleTime:1}),showDivId:Te.transactionFailure});try{ue(JSON.parse(null==e?void 0:e.statusText))}catch(t){ue({errorMsg:null==e?void 0:e.statusText})}}else ue({title:l(Ee.errorOccuredHeading),errorMsg:l(Ee.purchasingUnavailableMessage),showDivId:Te.transactionFailure})}))))}(0,t.useEffect)((function(){ae&&se(!0)}),[ae]);var pe=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var r,n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={collectibleItemId:G,expectedCurrency:C,expectedPrice:t,expectedPurchaserId:E.CurrentUser.userId,expectedPurchaserType:"User",expectedSellerId:D,expectedSellerType:L,idempotencyKey:a.uuidService.generateRandomUuid()},W&&(r.collectibleItemInstanceId=W),z&&(r.collectibleProductId=z),H)return H({params:r,handleError:ue,setLoading:Q,openConfirmation:de,closeAll:le}),e.abrupt("return");e.next=6;break;case 6:return Q(!0),o=W?oe.purchaseCollectibleItemInstance:oe.purchaseCollectibleItem,e.prev=8,e.next=11,o(G,r);case 11:if(o=e.sent,n=o.data,i=n.transactionVerb,Q(!1),le(),!("number"==typeof(o=null!==(o=n.statusCode)&&void 0!==o?o:n.status)&&400<=o||!1===(null==n?void 0:n.purchased))){e.next=21;break}!1===(null==n?void 0:n.purchased)&&"TwoStepVerificationRequired"===(null==n?void 0:n.reason)?s():!1===(null==n?void 0:n.purchased)&&"Flooded"===(null==n?void 0:n.purchaseResult)?ue({title:l(Ee.errorOccuredHeading),errorMsg:l(Ee.floodcheckFailureMessage,{throttleTime:1}),showDivId:Te.transactionFailure}):ue({title:l(Ee.errorOccuredHeading),errorMsg:l(Ee.purchasingUnavailableMessage),showDivId:Te.transactionFailure,onDecline:function(){window.location.reload()}}),e.next=26;break;case 21:if(V(),k)return f.success(l(Ee.purchaseCompleteHeading)),e.abrupt("return");e.next=25;break;case 25:de({assetIsWearable:!0,transactionVerb:i,itemDelayed:null==n?void 0:n.pending,onDecline:function(){window.location.reload()}});case 26:e.next=37;break;case 28:if(e.prev=28,e.t0=e.catch(8),console.debug(e.t0),E.AccountIntegrityChallengeService.Generic.ChallengeError.matchAbandoned(Y))return Q(!1),e.abrupt("return");e.next=34;break;case 34:if(Q(!1),le(),e.t0&&(null===e.t0||void 0===e.t0?void 0:e.t0.statusText)!==Re.badRequest){429===e.t0.status&&ue({title:l(Ee.errorOccuredHeading),errorMsg:l(Ee.floodcheckFailureMessage,{throttleTime:1}),showDivId:Te.transactionFailure});try{ue(JSON.parse(null===e.t0||void 0===e.t0?void 0:e.t0.statusText))}catch(t){ue({errorMsg:null===e.t0||void 0===e.t0?void 0:e.t0.statusText})}}else ue({title:l(Ee.errorOccuredHeading),errorMsg:l(Ee.purchasingUnavailableMessage),showDivId:Te.transactionFailure});case 37:case"end":return e.stop()}}),e,null,[[8,28]])})),function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function s(e){we(i,n,a,s,o,"next",e)}function o(e){we(i,n,a,s,o,"throw",e)}s(void 0)}))});return function(){return t.apply(this,arguments)}}();$=u?r().createElement(u,Pe({},Pe({assetName:c,assetType:S,expectedPrice:F,thumbnail:q,sellerName:B,loading:X,onAction:function(){return me(F)}},$))):r().createElement(g,{expectedPrice:F,thumbnail:q,assetName:c,assetType:S,assetTypeDisplayName:w,sellerName:B,isPlace:_,loading:X,collectibleItemId:G,collectibleItemInstanceId:W,onAction:function(){return me(F),!1}});return 0<ee&&E.ItemPurchaseUpsellService&&ce(ee,null!=K?K:F),r().createElement(r().Fragment,null,r().createElement(ve,{isTwoStepVerificationActive:ae,stopTwoStepVerification:function(){return ie(!1)},systemFeedbackService:y}),0<ee?r().createElement(v,{robuxNeeded:ee}):$,Y&&r().createElement(x,{title:Y.title,message:Y.message,onDecline:Y.onDecline}),null!=K&&r().createElement(T,{expectedPrice:F,currentPrice:K,loading:X,onAction:function(){return me(K),!1}}),re&&r().createElement(P,Pe({thumbnail:q,assetName:c,assetType:S,assetTypeDisplayName:w,sellerName:B,isPlace:_,isPrivateServer:j,expectedPrice:K||F},re)),k&&r().createElement(p,null),i&&r().createElement(b,null))}return C.defaultProps={isPlace:!1,isPrivateServer:!1,productId:null,assetTypeDisplayName:"",expectedPromoId:0,userAssetId:0,showSuccessBanner:!1,handlePurchase:null,onPurchaseSuccess:function(){return null},customProps:{},collectibleItemId:null,collectibleItemInstanceId:null,collectibleProductId:null,sellerType:null},C.propTypes={translate:s().func.isRequired,productId:function(e,t,r){var n=e.collectibleItemId,a=e.productId;return n||"number"==typeof a?null:new Error("Invalid prop ".concat(t," supplied to ").concat(r,". Validation failed."))},expectedCurrency:s().number.isRequired,expectedPrice:s().number.isRequired,thumbnail:s().node.isRequired,assetName:s().string.isRequired,assetType:s().string.isRequired,assetTypeDisplayName:s().string,expectedSellerId:s().number.isRequired,sellerName:s().string.isRequired,sellerType:s().string,isPlace:s().bool,isPrivateServer:s().bool,expectedPromoId:s().number,userAssetId:s().number,showSuccessBanner:s().bool,handlePurchase:s().func,onPurchaseSuccess:s().func,customProps:s().func,collectibleItemId:s().string,collectibleItemInstanceId:s().string,collectibleProductId:s().string},[(0,o.withTranslations)(C,c.purchasingResources),{start:function(){(d||h).open(),n()}}]}var Ne=HeaderScripts,Ce=N.getItemDetailsUrl,Fe=(N.postItemDetailsUrl,N.getPurchaseableDetailUrl),De=N.getResellerDataUrl,Oe=N.getMetaDataUrl,Ue=(N.getCollectibleItemDetailsUrl,N.getCurrentUserBalance),qe=function(e,t){return t={url:Ce(e,t),retryable:!0,withCredentials:!0},a.httpService.get(t)},Be=function(e){return e={url:Fe(e),retryable:!0,withCredentials:!0},a.httpService.get(e)},Le=function(e){return e={url:De(e),retryable:!0,withCredentials:!0},a.httpService.get(e)},ke=function(){var e={url:Oe(),retryable:!0,withCredentials:!0};return a.httpService.get(e)};function _e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return je(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?je(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function je(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var He=y,Ve=function(){var e=document.getElementById("item-container");return e?{itemDetailItemId:parseInt(e.getAttribute("data-item-id"),10),itemDetailItemType:e.getAttribute("data-item-type")}:null},Ge=RobloxThumbnails;function We(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ze=Me(),$e=(xt=2,xt=function(e){if(Array.isArray(e))return e}(ze)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}}(ze,xt)||function(e,t){if(e){if("string"==typeof e)return We(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?We(e,t):void 0}}(ze,xt)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],Xe=xt[1],Qe=p,Ye=N.getPremiumConversionUrl;function Je(e){var t=e.translate,n=e.productId,a=e.price,i=e.itemName,s=e.itemType,o=e.assetTypeDisplayName,c=e.sellerName,u=e.expectedSellerId,d=e.isPurchasable,m=e.isOwned,p=e.isPlugin,f=e.itemDetailItemId,b=e.loading,y=e.userQualifiesForPremiumPrices,g=e.premiumPriceInRobux,h=e.isAuthenticated,v=e.resellerAvailable,S=e.firstReseller;v=e.isMarketPlaceEnabled&&(v||d),d=function(){return t(0===a?Qe.getAction:Qe.buyAction)};return b?r().createElement(l.Loading,null):h?(h=r().createElement(Ge.Thumbnail2d,{type:"bundle"===s?Ge.ThumbnailTypes.bundleThumbnail:Ge.ThumbnailTypes.assetThumbnail,size:Ge.DefaultThumbnailSize,targetId:f,format:Ge.ThumbnailFormat.png,altName:i}),p&&(m||0===a)?r().createElement(r().Fragment,null,r().createElement(l.Button,{className:"btn-fixed-width-lg btn-primary-lg InstallButton",onClick:function(){var e;e=f,E.GameLauncher.openPluginInStudio(e)}},r().createElement("span",null,t(Qe.installAction)))):r().createElement(r().Fragment,null,r().createElement(l.Button,{className:"btn-fixed-width-lg btn-growth-lg PurchaseButton",onClick:Xe.start,isDisabled:!v},d()),r().createElement($e,{productId:n,expectedPrice:y&&null!=g?g:a,thumbnail:h,assetTypeDisplayName:o,assetName:i,sellerName:S?S.seller.name:c,expectedSellerId:S?S.seller.id:u,userAssetId:S?S.userAssetId:0,showSuccessBanner:!0}))):null!=g?r().createElement(l.Button,{id:"upgrade-button",className:"btn-fixed-width-lg btn-primary-lg",onClick:function(){A.paymentFlowAnalyticsService.sendUserPurchaseFlowEvent(A.paymentFlowAnalyticsService.ENUM_TRIGGERING_CONTEXT.WEB_PREMIUM_PURCHASE,!1,A.paymentFlowAnalyticsService.ENUM_VIEW_NAME.PREMIUM_UPSELL,A.paymentFlowAnalyticsService.ENUM_PURCHASE_EVENT_TYPE.USER_INPUT,A.paymentFlowAnalyticsService.ENUM_VIEW_MESSAGE.GET_PREMIUM),window.open(Ye(f,s))}},t(Qe.getPremiumAction)):r().createElement(l.Button,{className:"btn-fixed-width-lg btn-growth-lg PurchaseButton",onClick:function(){window.location="/login"}},d())}Je.propTypes={translate:s().func.isRequired,productId:s().number.isRequired,price:s().number.isRequired,itemName:s().string.isRequired,itemType:s().string.isRequired,assetTypeDisplayName:s().string.isRequired,sellerName:s().string.isRequired,expectedSellerId:s().number.isRequired,isPurchasable:s().bool.isRequired,isOwned:s().bool.isRequired,isPlugin:s().bool.isRequired,itemDetailItemId:s().number.isRequired,loading:s().bool.isRequired,userQualifiesForPremiumPrices:s().bool.isRequired,premiumPriceInRobux:s().number.isRequired,isAuthenticated:s().bool.isRequired,resellerAvailable:s().bool.isRequired,firstReseller:s().shape({seller:{name:s().string.isRequired,id:s().number.isRequired},userAssetId:s().number.isRequired}).isRequired,isMarketPlaceEnabled:s().bool.isRequired};var Ke=(0,o.withTranslations)(Je,c.itemResources),Ze=p;function et(e){var t=e.translate,n=e.isLimited;e=e.resellerAvailable,e=n&&e;return r().createElement("div",{className:"text-label field-label price-label"},r().createElement("span",null,t(e?Ze.bestPriceLabel:Ze.priceLabel)))}et.propTypes={translate:s().func.isRequired,isLimited:s().bool.isRequired,resellerAvailable:s().bool.isRequired};var tt=(0,o.withTranslations)(et,c.itemResources),rt=p,nt=y,at=N.getPremiumConversionUrl;function it(e){function t(e){A.paymentFlowAnalyticsService.sendUserPurchaseFlowEvent(A.paymentFlowAnalyticsService.ENUM_TRIGGERING_CONTEXT.WEB_PREMIUM_PURCHASE,!1,A.paymentFlowAnalyticsService.ENUM_VIEW_NAME.PREMIUM_UPSELL,A.paymentFlowAnalyticsService.ENUM_PURCHASE_EVENT_TYPE.USER_INPUT,e.target.innerText)}var n=e.translate,i=e.price,s=e.itemType,o=e.itemDetailItemId,c=e.premiumPriceInRobux,u=e.premiumDiscountPercentage,d=e.userQualifiesForPremiumPrices,m=e.isOwned,p=e.loading,f=e.loadFailure,b=e.unitsAvailableForConsumption,y=e.isLimited,g=e.isPlugin,h=e.resellerAvailable,v=e.priceStatus,S=e.offSaleDeadline,P=e.isMarketPlaceEnabled,w=null==c&&null==i,E=!0;e="";return p?r().createElement(l.Loading,null):(!p&&f?e=nt.retryErrorMessage:v===rt.offSale&&null===S?e=n(rt.itemNoLongerForSaleLabel):P||m?g||!m||y?y&&0===b&&!h?e=n(rt.noOneCurrentlySellingLabel):E=!1:e=n(rt.itemAvailableInventoryLabel):e=n(rt.purchasingTemporarilyUnavailableLabel),0===i?null:E&&!m?r().createElement("div",{className:"price-container-text"},r().createElement("div",{className:"item-first-line"}," ",e," ")):r().createElement(r().Fragment,null,r().createElement("div",{className:"price-container-text"},E?r().createElement("div",{className:"item-first-line"}," ",e," "):null,r().createElement(tt,{translate:n,isLimited:y,resellerAvailable:h}),r().createElement("div",{className:"price-info"},r().createElement("div",{className:"icon-text-wrapper clearfix icon-robux-price-container"},w?r().createElement("span",{className:"icon-robux-16x16 icon-robux-gray-16x16 wait-for-i18n-format-render"}):r().createElement("span",{className:"icon-robux-16x16 wait-for-i18n-format-render"}),r().createElement("span",{className:"text-robux-lg wait-for-i18n-format-render"},d&&null!=c?a.numberFormat.getNumberFormat(c):a.numberFormat.getNumberFormat(i)))),function(){if(null==c||m)return null;if(null==i)return d?r().createElement("span",{className:"small text field-content empty-label wait-for-i18n-format-render"},n(rt.premiumExclusiveEligiblePromptLabel)):r().createElement("span",{className:"small text field-content empty-label wait-for-i18n-format-render"},n(rt.premiumExclusiveIneligiblePromptLabel));var e={originalPrice:(0,I.renderToString)(r().createElement(D,{price:i})),discountPercentage:u,premiumDiscountedPrice:(0,I.renderToString)(r().createElement(D,{price:c}))};return r().createElement(r().Fragment,null,r().createElement("div",{className:"text-label field-label empty-label"},"Â "),r().createElement("span",{className:"premium-prompt small text field-content empty-label wait-for-i18n-format-render"},d?r().createElement("a",{"aria-label":" ",href:at(o,s),dangerouslySetInnerHTML:{__html:n(rt.premiumDiscountSavingsLabel,e)},onClick:function(e){t(e),window.open(at(o,s))}}):r().createElement("a",{"aria-label":" ",href:at(o,s),dangerouslySetInnerHTML:{__html:n(rt.premiumDiscountOpportunityPromptLabel,e)},onClick:function(e){t(e),window.open(at(o,s))}})))}())))}it.propTypes={translate:s().func.isRequired,price:s().number.isRequired,itemType:s().string.isRequired,itemDetailItemId:s().number.isRequired,premiumPriceInRobux:s().number.isRequired,premiumDiscountPercentage:s().number.isRequired,userQualifiesForPremiumPrices:s().bool.isRequired,loading:s().bool.isRequired,isOwned:s().bool.isRequired,loadFailure:s().bool.isRequired,unitsAvailableForConsumption:s().number.isRequired,isLimited:s().bool.isRequired,isPlugin:s().bool.isRequired,resellerAvailable:s().bool.isRequired,priceStatus:s().string.isRequired,offSaleDeadline:s().string.isRequired,isMarketPlaceEnabled:s().bool.isRequired};var st=(0,o.withTranslations)(it,c.itemModelResources);function ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return lt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?lt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ct=p;function ut(e){var n=e.translate,a=e.offSaleDeadline,i=(e=ot((0,t.useState)(0),2))[0],s=e[1],o=(e=ot((0,t.useState)(0),2))[0],l=e[1],c=(e=ot((0,t.useState)(0),2))[0],u=e[1],d=(e=ot((0,t.useState)(0),2))[0],m=e[1];return(0,t.useEffect)((function(){function e(){var e;new Date<new Date(a)&&(e=+new Date,e=(new Date(a).getTime()-e)/1e3,s(Math.floor(e/86400)),l(Math.floor(e/3600%24)),u(Math.floor(e/60%60)),m(Math.floor(e%60)))}var t;return e(),t=setInterval(e,1e3),function(){return clearInterval(t)}}),[s,l,u,m]),r().createElement("div",{id:"sale-clock",className:"text-error sale-clock desktop-sale-clock"},function(){if(i<1){var e={numberOfHours:o,numberOfMinutes:c,numberOfSeconds:d};return r().createElement("div",{className:"text",dangerouslySetInnerHTML:{__html:n(ct.OffsaleCountdownHourMinuteSecondLabel,e)}})}return d<1?(window.location.reload(),null):(e={numberOfDays:i,numberOfHours:o,numberOfMinutes:c},r().createElement("div",{className:"text",dangerouslySetInnerHTML:{__html:n(ct.CountdownTimerDayHourMinute,e)}}))}())}ut.propTypes={translate:s().func.isRequired,offSaleDeadline:s().string.isRequired};var dt=(0,o.withTranslations)(ut,c.itemResources),mt=p,pt=f,ft=b,bt=N.getInventoryUrl;function yt(e){var t=e.translate,n=e.assetType,a=Ne.deviceMeta.getDeviceMeta(),i="phone"===a.deviceType,s=(e=bt(Ne.authenticatedUser.id),n===pt.Plugin||n===pt.Decal||n===pt.Model||n===pt.Video||n===pt.Animation?ft.Library:n===pt.Place||n===pt.Badge||n===pt.GamePass||n===pt.Animation?null:ft.Catalog);return s!==ft.Catalog||a.isInApp||!Ne.deviceMeta.isAndroidApp&&!Ne.deviceMeta.isIosApp||!Ne.deviceMeta.isPhone&&!Ne.deviceMeta.isTablet?s!==ft.Catalog||i?r().createElement("a",{id:"inventory-button",href:e,className:"btn-fixed-width-lg btn-control-md"},t(mt.inventoryAction)):r().createElement("a",{id:"edit-avatar-button",href:"/my/avatar",className:"btn-control-md"},r().createElement("span",{className:"icon-nav-charactercustomizer"})):r().createElement("a",{id:"open-in-avatar-editor-button",href:"/#",className:"btn-fixed-width-lg btn-control-md"},r().createElement("span",{className:"icon-nav-charactercustomizer"}))}yt.propTypes={translate:s().func.isRequired,assetType:s().number.isRequired};var gt=(0,o.withTranslations)(yt,c.itemResources),ht=Ve,vt=f;function St(e){var n=e.translate,a=(e=ht()).itemDetailItemId,i=(e=e.itemDetailItemType,function(e,r,n){function a(){o({loading:!1,loadFailure:!0})}var i=_e((0,t.useState)({expectedSellerId:0,owned:!1,isPurchasable:!1,id:0,itemType:"",assetType:"",name:"",description:"",productId:0,creatorTargetId:0,creatorName:"",price:null,loading:!0,loadFailure:!1,premiumPricing:null,premiumDiscountPercentage:null,hasLimitedPrivateSales:!1,isPublicDomain:!1,premiumPriceInRobux:null,assetTypeDisplayName:"",offSaleDeadline:null,unitsAvailableForConsumption:0,isLimited:!1,resellerAvailable:!1,firstReseller:{},priceStatus:"",isMarketPlaceEnabled:!0}),2),s=i[0],o=i[1],l=(0,t.useCallback)((function(){e(r,n).then((function(e){var t={expectedSellerId:(e=e.data).expectedSellerId,owned:e.owned,id:e.id,itemType:e.itemType,assetType:e.assetType,name:e.name,description:e.description,productId:e.productId,price:e.price,lowestPrice:e.lowestPrice,creatorTargetId:e.creatorTargetId,creatorName:e.creatorName,hasLimitedPrivateSales:void 0!==e.lowestPrice,isPublicDomain:0===e.price,offSaleDeadline:e.offSaleDeadline,isLimited:e.itemRestrictions.includes("Limited")||e.itemRestrictions.includes("LimitedUnique"),unitsAvailableForConsumption:void 0!==e.unitsAvailableForConsumption?e.unitsAvailableForConsumption:0,priceStatus:void 0!==e.priceStatus?e.priceStatus:""};void 0!==e.premiumPricing&&(t.premiumPriceInRobux=e.premiumPricing.premiumPriceInRobux,t.premiumDiscountPercentage=e.premiumPricing.premiumDiscountPercentage),t.isLimited&&(t.price=void 0!==t.lowestPrice?t.lowestPrice:t.price,Le(t.id).then((function(e){t.resellerAvailable=0<e.data.data.length,t.resellerAvailable&&(e=_e(e.data.data,1)[0],t.price=e.price,t.firstReseller=e)}))),Be(e.productId).then((function(e){!e.data.purchasable&&e.data.reason&&e.data.reason!==He.insufficientFunds?t.isPurchasable=e.data.purchasable:t.isPurchasable=!0,t.assetTypeDisplayName=e.data.assetTypeDisplayName,t.loading=!1,t.loadFailure=!1,ke().then((function(e){t.isMarketPlaceEnabled=e.data.isMarketPlaceEnabled&&e.data.isItemsXchangeEnabled,o(t)})).catch((function(){a()}))})).catch((function(e){e.statusText===He.unauthorizedMessage?(t.loading=!1,t.loadFailure=!1,o(t)):a()}))})).catch((function(){a()}))}),[r,n,e]);return(0,t.useEffect)((function(){l()}),[]),{itemDetail:s,loadItemDetail:l}}(qe,a,e).itemDetail);return r().createElement(r().Fragment,null,r().createElement(st,{translate:n,price:i.price,itemType:i.itemType,itemDetailItemId:a,premiumPriceInRobux:i.premiumPriceInRobux,premiumDiscountPercentage:i.premiumDiscountPercentage,userQualifiesForPremiumPrices:Ne.authenticatedUser.isPremiumUser,isOwned:i.owned,loading:i.loading,loadFailure:i.loadFailure,unitsAvailableForConsumption:i.unitsAvailableForConsumption,isLimited:i.isLimited,isPlugin:i.assetType===vt.Plugin,resellerAvailable:i.resellerAvailable,priceStatus:i.priceStatus,offSaleDeadline:i.offSaleDeadline,isMarketPlaceEnabled:i.isMarketPlaceEnabled}),!i.loadFailure&&(i.owned&&(!i.isLimited||0<i.unitsAvailableForConsumption)?r().createElement("div",{className:"action-button"},r().createElement(gt,{translate:n,assetType:i.assetType})):r().createElement("div",{className:"action-button"},r().createElement(Ke,{translate:n,productId:i.productId,price:i.price,itemType:i.itemType,assetTypeDisplayName:i.assetTypeDisplayName,itemName:i.name,sellerName:i.creatorName,expectedSellerId:i.expectedSellerId,isPurchasable:i.isPurchasable,isOwned:i.owned,isInstallable:i.assetType===vt.Plugin,itemDetailItemId:a,loading:i.loading,hasLimitedPrivateSales:i.hasLimitedPrivateSales,userQualifiesForPremiumPrices:Ne.authenticatedUser.isPremiumUser,premiumPriceInRobux:i.premiumPriceInRobux,isAuthenticated:Ne.authenticatedUser.isAuthenticated,unitsAvailableForConsumption:i.unitsAvailableForConsumption,isLimited:i.isLimited,resellerAvailable:i.resellerAvailable,firstReseller:i.firstReseller,isMarketPlaceEnabled:i.isMarketPlaceEnabled}),null!==i.offSaleDeadline&&r().createElement(dt,{translate:n,offSaleDeadline:i.offSaleDeadline}))))}St.propTypes={translate:s().func.isRequired};var Pt=St;function wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function It(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function At(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?It(Object(r),!0).forEach((function(t){var n,a;n=e,t=r[a=t],a in n?Object.defineProperty(n,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[a]=t})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):It(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}i=function(e,t){return e=At(At({},e),{},{expectedSellerId:t.expectedSellerId,owned:t.owned,id:t.id,itemType:t.itemType,assetType:t.assetType,name:t.name,description:t.description,productId:t.productId,price:t.price,lowestPrice:t.lowestPrice,creatorTargetId:t.creatorTargetId,creatorName:t.creatorName,hasLimitedPrivateSales:void 0!==t.lowestPrice,isPublicDomain:0===t.price,offSaleDeadline:t.offSaleDeadline,isLimited:t.itemRestrictions.includes("Limited")||t.itemRestrictions.includes("LimitedUnique"),unitsAvailableForConsumption:void 0!==t.unitsAvailableForConsumption?t.unitsAvailableForConsumption:0,priceStatus:null!==(e=t.priceStatus)&&void 0!==e?e:t.priceStatus}),void 0!==t.premiumPricing&&(e.premiumPriceInRobux=t.premiumPricing.premiumPriceInRobux,e.premiumDiscountPercentage=t.premiumPricing.premiumDiscountPercentage),e.isLimited&&(e.price=void 0!==e.lowestPrice?e.lowestPrice:e.price),e};var Et,Tt=function(e,t){return(e=At({},e)).resellerAvailable=0<t.data.data.length,e.resellerAvailable&&(t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return wt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?wt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t.data.data,1)[0],e.price=t.price,e.firstReseller=t),e},Rt=function(e,t,r){var n=y;e=At({},e);return!t.purchasable&&t.reason&&t.reason!==n.insufficientFunds?e.isPurchasable=t.purchasable:e.isPurchasable=!0,e.assetTypeDisplayName=t.assetTypeDisplayName,e.loading=!1,e.loadFailure=!1,e.isMarketPlaceEnabled=r.data.isMarketPlaceEnabled&&r.data.isItemsXchangeEnabled,e},xt=function(e){return(e=At({},e)).isPurchasable=!1,e};(Ve=Et=Et||{}).Asset="asset",Ve.Bundle="bundle";var Mt=Et;function Nt(e,t,r,n,a,i,s){try{var o=e[i](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function Ct(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function s(e){Nt(i,n,a,s,o,"next",e)}function o(e){Nt(i,n,a,s,o,"throw",e)}s(void 0)}))}}function Ft(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Dt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Dt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ot=h,Ut=i,qt=Tt,Bt=Rt,Lt=xt;(xt=Kt=Kt||{}).Success="Success",xt.AlreadyOwned="AlreadyOwned",xt.InsufficientFunds="InsufficientFunds",xt.ExceptionOccured="ExceptionOccurred",xt.TooManyPurchases="TooManyPurchases",xt.CaughtError="CaughtError",xt.PremiumNeeded="InsufficientMembership",xt.NoSellers="NotForSale";var kt=Kt;function _t(e,t,r,n,a,i,s){try{var o=e[i](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function jt(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function s(e){_t(i,n,a,s,o,"next",e)}function o(e){_t(i,n,a,s,o,"throw",e)}s(void 0)}))}}function Ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Vt=p,Gt=g,Wt=v;function zt(e){var t=e.itemsCount,n=e.item,a=e.index,i=n.name;e=t-Gt,a=Gt<t&&a===Gt-1;return r().createElement("div",{className:"modal-multi-item-image-container"},r().createElement(Ge.Thumbnail2d,{type:n.itemType===Mt.Bundle?Ge.ThumbnailTypes.bundleThumbnail:Ge.ThumbnailTypes.assetThumbnail,size:Ge.DefaultThumbnailSize,targetId:n.id,containerClass:"batch-buy-thumbnail",format:Ge.ThumbnailFormat.png,altName:i}),a&&r().createElement("div",{className:"thumb-overlay"},r().createElement("div",{className:"font-header-1"},"ï¼",e)))}function $t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Xt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Xt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Qt,Yt=(xt=$t(B(),2))[0],Jt=xt[1],Kt=$t((Qt=(Rt=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ht(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ht(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,l.createModal)(),2))[0],Rt=Rt[1],tr.defaultProps={title:"",loading:!1},tr.propTypes={translate:s().func.isRequired,title:s().string,expectedTotalPrice:s().number.isRequired,currentRobuxBalance:s().number.isRequired,itemDetails:s().arrayOf(s().shape({productId:s().number.isRequired,price:s().number.isRequired,itemName:s().string.isRequired,itemType:s().string.isRequired,assetTypeDisplayName:s().string.isRequired,sellerName:s().string.isRequired,expectedSellerId:s().number.isRequired,isPurchasable:s().bool.isRequired,isOwned:s().bool.isRequired,isPlugin:s().bool.isRequired,itemDetailItemId:s().number.isRequired,loading:s().bool.isRequired,userQualifiesForPremiumPrices:s().bool.isRequired,premiumPriceInRobux:s().number.isRequired,isAuthenticated:s().bool.isRequired,resellerAvailable:s().bool.isRequired,firstReseller:s().shape({seller:{name:s().string.isRequired,id:s().number.isRequired},userAssetId:s().number.isRequired}).isRequired,isMarketPlaceEnabled:s().bool.isRequired})).isRequired,onCancel:s().func.isRequired,onTransactionComplete:s().func.isRequired,onAction:s().func.isRequired,loading:s().bool,systemFeedbackService:s().func.isRequired},[(0,o.withTranslations)(tr,c.purchasingResources),Rt]),2),Zt=Kt[0],er=Kt[1];function tr(e){var n,a=e.translate,i=e.title,s=e.expectedTotalPrice,o=e.itemDetails,l=e.currentRobuxBalance,c=e.onCancel,u=e.onTransactionComplete,d=e.onAction,m=e.loading,p=e.systemFeedbackService,f={itemCount:o.length,robux:(0,I.renderToString)(r().createElement("span",{className:"robux-price"},r().createElement(D,{price:s})))},b=Vt.batchBuyPromptMessage,y=0===s?(n=a(Vt.getItemHeading),a(Vt.getNowAction)):(n=a(Vt.buyItemHeading),a(Vt.buyNowAction));e=null==o?void 0:o.slice(0,Gt);function g(){return(g=jt(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={expectedPrice:t.premiumPriceInRobux&&Ne.authenticatedUser.isPremiumUser?t.premiumPriceInRobux:t.price,expectedSellerId:t.firstReseller?t.firstReseller.seller.id:void 0,userAssetId:t.firstReseller?t.firstReseller.userAssetId:void 0},e.prev=1,e.next=4,oe.purchaseItem(t.productId,r);case 4:n=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),n={data:{assetId:t.itemType===Mt.Asset?t.id:void 0,bundleId:t.itemType===Mt.Bundle?t.id:void 0,reason:kt.CaughtError}};case 10:return e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}function h(e){var t=function(e){var t=0,r=[];if(e.forEach((function(e){var n;e.data.reason===kt.Success?t+=1:(n=r.find((function(t){return t.error===e.data.reason})))?n.count+=1:r.push({error:e.data.reason,count:1})})),t===e.length)return{success:!0,message:Vt.purchaseCompleteHeading};var n={error:"",count:0};if(r.forEach((function(e){e.count>n.count&&(n=e)})),0<t)switch(n.error){case kt.AlreadyOwned:return{success:!1,message:Vt.batchBuyPartialSuccessItemsOwnedFailureMessage,params:{itemCountSuccess:t,itemCountFailure:n.count}};case kt.InsufficientFunds:return{success:!1,message:Vt.batchBuyPartialSuccessInsufficientFundsFailureMessage,params:{itemCountSuccess:t,itemCountFailure:n.count}};case kt.ExceptionOccured:return{success:!1,message:Vt.batchBuyPartialSuccessNetworkErrorFailureMessage,params:{itemCountSuccess:t,itemCountFailure:n.count}};case kt.TooManyPurchases:return{success:!1,message:Vt.batchBuyPartialSuccessFloodcheckFailureMessage,params:{itemCountSuccess:t,itemCountFailure:n.count}};case kt.PremiumNeeded:return{success:!1,message:Vt.batchBuyPartialSuccessPremiumNeededFailureMessage,params:{itemCountSuccess:t,itemCountFailure:n.count}};case kt.NoSellers:return{success:!1,message:Vt.batchBuyPartialSuccessNoSellersFailureMessage,params:{itemCountSuccess:t,itemCountFailure:n.count}};default:return{success:!1,message:Vt.batchBuyPartialSuccessGeneralFailureMessage,params:{itemCountSuccess:t,itemCountFailure:n.count}}}else switch(n.error){case kt.AlreadyOwned:return{success:!1,message:Vt.batchBuyItemsOwnedFailureMessage};case kt.InsufficientFunds:return{success:!1,message:Vt.insufficientFundsFailureMessage};case kt.ExceptionOccured:return{success:!1,message:Vt.networkErrroFailureMessage};case kt.TooManyPurchases:return{success:!1,message:Vt.floodcheckFailureMessage,params:{throttleTime:Wt}};case kt.PremiumNeeded:return{success:!1,message:Vt.premiumNeededFailureMessage};case kt.NoSellers:return{success:!1,message:Vt.noSellersFailureMessage};default:return{success:!1,message:Vt.purchaseErrorFailureMessage}}}(e);e=t.params?a(t.message,t.params):a(t.message);t.success?p.success(e):p.warning(e)}function v(){return(v=jt(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(o.map((function(e){return function(){return g.apply(this,arguments)}(e)})));case 2:h(t=e.sent),u(t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return e=r().createElement(t.Fragment,null,r().createElement("div",{className:"modal-message multi-item",dangerouslySetInnerHTML:{__html:a(b,f)}}),void 0!==o&&0<o.length&&r().createElement("div",{className:"modal-multi-item-images-container"},e.map((function(e,t){return r().createElement(zt,{key:e.itemId,itemsCount:o.length,item:e,index:t})})))),r().createElement(Qt,{title:i||n,body:e,neutralButtonText:a(Vt.cancelAction),actionButtonText:y,onAction:function(){!function(){v.apply(this,arguments)}(),d()},onNeutral:function(){c()},footerText:r().createElement(j,{expectedPrice:s,currentRobuxBalance:l}),loading:m,actionButtonShow:o})}var rr=p;function nr(e){var n=e.currentUserBalance,i=e.items,s=e.itemDetails,o=e.onBuyButtonClick,c=e.onConfirm,u=e.onCancel,d=e.onTransactionComplete,m=e.systemFeedbackService,p=e.translate,f=!1,b=0,y=0,g=[],h=$t((0,t.useState)(!1),2),v=(e=h[0],h[1]);if(!Ne.authenticatedUser.isAuthenticated)return r().createElement("div",{className:"sign-in"},r().createElement(l.Button,{className:"action-button batch-buy-purchase-button sign-in-button",variant:l.Button.variants.growth,size:l.Button.sizes.large,onClick:function(){var e;window.location=(e={ReturnUrl:window.location.pathname},a.urlService.getUrlWithQueries("/login",e))}},p(rr.buyAction)));if(void 0===s||0<s.length&&s[0]&&s[0].loading||void 0===n)return r().createElement("div",{className:"loading"},r().createElement(l.Button,{className:"action-button batch-buy-purchase-button",variant:l.Button.variants.growth,size:l.Button.sizes.large,isDisabled:!0},r().createElement(l.Loading,null)));if(0===s.length||s[0]&&s[0].loadFailure)return r().createElement(l.Button,{className:"action-button batch-buy-purchase-button",variant:l.Button.variants.growth,size:l.Button.sizes.large,isDisabled:!0},p(rr.buyAction));s.forEach((function(e){e.isMarketPlaceEnabled&&(e.resellerAvailable||e.isPurchasable)&&(f=!0),e.premiumPriceInRobux&&Ne.authenticatedUser.isPremiumUser?y+=e.premiumPriceInRobux:e.price&&(b+=e.price),e.resellerAvailable&&g.push(e)}));var S=b+y-n;return r().createElement(r().Fragment,null,r().createElement("div",null,r().createElement(l.Button,{className:"action-button batch-buy-purchase-button",variant:l.Button.variants.growth,size:l.Button.sizes.large,onClick:function(){(0<S?Jt:er).open(),o()},isDisabled:!f},e?r().createElement(l.Loading,null):p(rr.buyAction))),0<S&&r().createElement("div",{id:"insufficient-funds-modal"},r().createElement(Yt,{robuxNeeded:S})),r().createElement("div",{id:"multi-item-purchase-modal"},r().createElement(Zt,{title:p(rr.buyNowAction),expectedTotalPrice:b+y,items:i,itemDetails:s,resaleItems:g,currentRobuxBalance:n,onCancel:function(){var e;null==er||null!==(e=er.close)&&void 0!==e&&e.call(er),u()},onTransactionComplete:function(e){v(!1),d(e)},onAction:function(){var e;null==er||null!==(e=er.close)&&void 0!==e&&e.call(er),v(!0),c()},loading:!1,systemFeedbackService:m})))}nr.propTypes={currentUserBalance:s().number.isRequired,items:s().arrayOf(s().shape({id:s().number.isRequired,itemType:s().string.isRequired})).isRequired,itemDetails:s().arrayOf(s().shape({productId:s().number.isRequired,price:s().number.isRequired,itemName:s().string.isRequired,itemType:s().string.isRequired,assetTypeDisplayName:s().string.isRequired,sellerName:s().string.isRequired,expectedSellerId:s().number.isRequired,isPurchasable:s().bool.isRequired,isOwned:s().bool.isRequired,isPlugin:s().bool.isRequired,itemDetailItemId:s().number.isRequired,loading:s().bool.isRequired,loadFailure:s().bool,userQualifiesForPremiumPrices:s().bool.isRequired,premiumPriceInRobux:s().number,isAuthenticated:s().bool.isRequired,resellerAvailable:s().bool.isRequired,firstReseller:s().shape({seller:{name:s().string.isRequired,id:s().number.isRequired},userAssetId:s().number.isRequired}),isMarketPlaceEnabled:s().bool.isRequired})).isRequired,onBuyButtonClick:s().func.isRequired,onConfirm:s().func.isRequired,onCancel:s().func.isRequired,onTransactionComplete:s().func.isRequired,systemFeedbackService:s().func.isRequired,translate:s().func.isRequired};var ar=(0,o.withTranslations)(nr,c.purchasingResources);function ir(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sr(e){var n=e.items,i=e.onBuyButtonClick,s=e.systemFeedbackService,o=e.onConfirm,l=e.onCancel,c=e.onTransactionComplete,u=e.translate,d=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ir(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ir(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,t.useState)(void 0),2),m=(e=d[0],d[1]);return(0,t.useEffect)((function(){Ne.authenticatedUser.isAuthenticated&&function(e){return e={url:Ue(e),retryable:!0,withCredentials:!0},a.httpService.get(e)}(Ne.authenticatedUser.id).then((function(e){m(e.data.robux)})).catch((function(){m(void 0)}))}),[]),d=function(e){var r=(i=Ft((0,t.useState)(),2))[0],n=i[1],a=Ft((0,t.useState)([]),2),i=a[0],s=a[1],o=(a=Ft((0,t.useState)({}),2))[0],l=a[1],c=0,u=function(){c<Ot?(y(),c+=1):s([{loading:!1,loadFailure:!0}])},d=(0,t.useCallback)((function(){Ne.authenticatedUser.isAuthenticated?ke().then((function(e){n(e)})).catch((function(){u()})):n({data:{isMarketplaceEnabled:!1,isItemsXchangeEnabled:!1}})}),[]);function m(e){return p.apply(this,arguments)}function p(){return(p=Ct(regeneratorRuntime.mark((function e(t){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.inCache)return e.abrupt("return",o[t.itemType.toLowerCase()][t.id]);e.next=2;break;case 2:if((n=Ut({},t)).isLimited)return e.prev=4,e.next=7,Le(n.id);e.next=14;break;case 7:a=e.sent,n=qt(n,a),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),n.resellerAvailable=!1;case 14:if(Ne.authenticatedUser.isAuthenticated)return e.next=17,Be(t.productId);e.next=21;break;case 17:a=e.sent,n=Bt(n,a.data,r),e.next=22;break;case 21:n=Lt(n);case 22:return e.abrupt("return",n);case 23:case"end":return e.stop()}}),e,null,[[4,11]])})))).apply(this,arguments)}function f(){return(f=Ct(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(t.map((function(e){return m(e)})));case 3:r=e.sent,s(r),n=o,r.forEach((function(e){e.isLimited||o[e.itemType.toLowerCase()][e.id]||(n[e.itemType.toLowerCase()][e.id]=e)})),l(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),u();case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function b(){return(b=Ct(regeneratorRuntime.mark((function t(){var r,n,a,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=[],e.forEach((function(e){void 0===o[e.itemType.toLowerCase()][e.id]&&r.push(e)})),0<r.length)return a=[],r.map((function(e){return a.push({itemType:e.itemType,id:e.id})})),t.next=7,E.ItemDetailsHydrationService.getItemDetails(a);t.next=8;break;case 7:n=t.sent;case 8:return i=[],e.forEach((function(e){var t;void 0===o[e.itemType.toLowerCase()][e.id]?(t=n.find((function(t){return t.id===e.id&&t.itemType.toLowerCase()===e.itemType.toLowerCase()})))&&i.push(t):i.push({id:e.id,itemType:e.itemType,inCache:!0})})),t.abrupt("return",i);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var y=(0,t.useCallback)((function(){(function(){return b.apply(this,arguments)})().then((function(e){try{!function(){f.apply(this,arguments)}(e)}catch(e){u()}})).catch((function(){u()}))}),[r,e,m]);return(0,t.useEffect)((function(){var e={};e[Mt.Asset]={},e[Mt.Bundle]={},l(e),d()}),[]),(0,t.useEffect)((function(){void 0!==r&&y()}),[r,e]),{itemDetails:i,batchLoadItemDetails:y}}(n).itemDetails,r().createElement(ar,{currentUserBalance:e,items:n,itemDetails:d,systemFeedbackService:s,onBuyButtonClick:i,onConfirm:o,onCancel:l,onTransactionComplete:c,translate:u})}sr.propTypes={items:s().arrayOf(s().object).isRequired,onBuyButtonClick:s().func,onConfirm:s().func,onCancel:s().func,onTransactionComplete:s().func,systemFeedbackService:s().func.isRequired,translate:s().func.isRequired},sr.defaultProps={onBuyButtonClick:function(){},onConfirm:function(){},onCancel:function(){},onTransactionComplete:function(){}},xt=(0,o.withTranslations)(sr,c.purchasingResources),Kt=u,window.RobloxItemPurchase={createTransactionFailureModal:w,createInsufficientFundsModal:B,createPriceChangedModal:z,createPurchaseVerificationModal:K,createPurchaseConfirmationModal:ne,createItemPurchase:Me,errorTypeIds:Kt,getMetaData:L,BalanceAfterSaleText:j,PriceLabel:D,AssetName:X,TransactionVerb:Z,BatchBuyPriceContainer:xt},(0,a.ready)((function(){var e=document.getElementById("display-price-container");e&&(0,n.render)(r().createElement(Pt,null),e)}))}(),window.Roblox&&window.Roblox.BundleDetector&&window.Roblox.BundleDetector.bundleDetected("ItemPurchase");