(Roblox=Roblox||{}).ThumbnailUtils={addLightsToScene:function(e,t){var n,o,a,r,i,s,l,c=!1,d=$("#use-dynamic-thumbnail-lighting");return null!==d&&d.length>0&&(c="True"===d.data("use-dynamic-thumbnail-lighting")),c?(r=new THREE.AmbientLight(4473924),t.add(r),(n=new THREE.DirectionalLight(13948116)).target=t,n.position.set(-7.5,.5,-6).normalize(),t.add(n),(o=new THREE.DirectionalLight(11316396)).target=t,o.position.set(20,4,-0).normalize(),t.add(o),(a=new THREE.DirectionalLight(11316396)).target=t,a.position.set(0,1,1).normalize(),t.add(a)):(r=new THREE.AmbientLight(8882048),e.add(r),(i=new THREE.DirectionalLight(11316396)).position.set(-.671597898,.671597898,.312909544).normalize(),e.add(i),s=new THREE.DirectionalLight(4473924),l=(new THREE.Vector3).copy(i.position).negate().normalize(),s.position.set(l),e.add(s)),{scene:e,camera:t}}},$((function(){function e(e){var t,n;for(t in u)if(u[t].container==e)return u[t].renderer;return n={container:e,renderer:new THREE.WebGLRenderer({antialias:!0,alpha:!0})},u.push(n),n.renderer}function t(e){e.find("canvas").remove()}function n(t,n,o,a,r,i){function c(){return o.parent().width()}function d(){return o.parent().height()}function u(){g.render(x,w)}function f(){m.enabled&&m.update(),TWEEN.update(),u(),requestAnimationFrame(f)}function p(){w.aspect=c()/d(),w.updateProjectionMatrix(),g.setSize(c(),d())}var m,g=e(o),h=function(e){return!!e.parent()&&"string"==typeof e.parent().data("moderation-mode")}(o),b=4*new THREE.Vector3(a.aabb.max.x,a.aabb.max.y,a.aabb.max.z).length(),y=Math.max(b,l),v=void 0!==a.camera.fov?a.camera.fov:70,w=new THREE.PerspectiveCamera(v,c()/d(),s,y),x=new THREE.Scene;(new THREE.OBJMTLLoader).load(t,n,(function(e){(function(e,t){Roblox.ThumbnailUtils.addLightsToScene(e,t)})(x,w),x.add(w),x.add(e);var t=function(){g.setSize(c(),d());var e,t=g.domElement;return $(window).resize((function(){clearTimeout(e),e=setTimeout(p,100)})).on("beforeunload",(function(){$(t).hide()})),t}();m=function(){var e=new THREE.OrbitControls(w,o.get(0),a,"static");return h?(e.autoRotate=!1,e.minDistance=.1,e.noPan=!1,e.noKeys=!1,e.noResetToInitialCameraPosition=!0):(e.rotateSpeed=1.5,e.zoomSpeed=1.5,e.dynamicDampingFactor=.3),e.addEventListener("change",u),e}(),u(),f(),r(t)}),void 0,i)}var o=$("#image-retry-data"),a=o?o.data("ga-logging-percent"):0,r=window.GoogleAnalyticsEvents&&GoogleAnalyticsEvents.FireEvent||function(){},i=function(e){Math.random()<=a/100&&r(e)},s=.1,l=1e3,c=o?o.data("image-retry-max-times"):10,d=o?o.data("image-retry-timer"):1500,u=[];$.fn.load3DThumbnail=function(o,a){function r(e,t,n,o){function s(o){if(o.realRegeneration=!0,n-- >0)o.retriesDone++,setTimeout((function(){r(e,t,n,o)}),d);else{var a=+new Date-o.start;i(["ThumbnailGenTime","3D","Gave Up",a]),i(["ThumbnailGenRetries","3D","Gave Up",o.retriesDone])}}function l(e,n){var o=+new Date-n.start;e.Final?$.getJSON(e.Url,(function(e){n.realRegeneration&&(i(["ThumbnailGenTime","3D","Success",o]),i(["ThumbnailGenRetries","3D","Success",n.retriesDone])),t(e,n)})).fail((function(){i(["ThumbnailGenErrors","3D","Failure",e.Url]),i(["ThumbnailGenTime","3D","Failure",o]),i(["ThumbnailGenRetries","3D","Failure",n.retriesDone]),a("3D Thumbnail failed to load")})):s(n)}$.ajax({url:e+"&_="+$.now(),method:"GET",crossDomain:!0,contentType:"application/json; charset=utf-8",dataType:"json",xhrFields:{withCredentials:!0},cache:!1}).success((function(e){l(e,o)})).fail((function(){s(o)}))}var s=!1;return this.each((function(){var l,d=$(this);try{l=function(){function l(){f&&(clearTimeout(f),f=void 0),Roblox.ThumbnailSpinner.hide(d)}function u(t){var n=new MutationObserver((function(o){o.forEach((function(o){var a,r=o.removedNodes;if("childList"===o.type)for(a=0;a<r.length;++a)if(r[a]===t)return e(d).forceContextLoss(),void n.disconnect()}))}));n.observe(t.parentNode,{childList:!0})}var f,p={start:+new Date,realRegeneration:!1,retriesDone:0},m=Roblox.Endpoints.generateAbsoluteUrl(d.data("3d-url"),null,!0);m&&(t(d),f=setTimeout((function(){s||Roblox.ThumbnailSpinner.show(d)}),500),r(m,(function(e,r){var c=+new Date;n(e.obj,e.mtl,d,e,(function(e){if(t(d),!s){l(),d.append(e),u(e);var n=+new Date-c;r.realRegeneration&&i(["ThumbnailInBrowserRenderTime","3D","Success",n]),o(e,r)}}),a)}),c,p))},l()}catch(e){a(e)}})),{cancel:function(){s=!0}}}})),$((function(){function e(e){e.find("canvas").remove()}function t(e){var t,n;for(t in d)if(d[t].container===e)return d[t].renderer;return n={container:e,renderer:new THREE.WebGLRenderer({antialias:!0,alpha:!0})},d.push(n),n.renderer}function n(e,n,o){function a(){return e.parent().width()}function r(){return e.parent().height()}function i(e,t,n){var o,a;n.preload(),(new THREE.MTLLoader.MaterialCreator).setMaterials(n),t.children[1].geometry.computeBoundingBox(),o=t.children[1].geometry.boundingBox,(a=new THREE.Vector3).subVectors(o.max,o.min),a.multiplyScalar(.5),a.add(o.min),a.applyMatrix4(t.children[0].matrixWorld),t.children[1].geometry.applyMatrix((new THREE.Matrix4).makeTranslation(-a.x,-a.y,-a.z)),t.children[1].geometry.verticesNeedUpdate=!0,t.children[1].position.x=a.x,t.children[1].position.y=a.y,t.children[1].position.z=a.z,T[e]=t,t.matrixAutoUpdate=!1,R.add(t),++I===k&&d()}function d(){(function(e,t){Roblox.ThumbnailUtils.addLightsToScene(e,t)})(R,L),R.add(L);var e=function(){v.setSize(a(),r());var e,t=v.domElement;return $(window).resize((function(){clearTimeout(e),e=setTimeout(m,100)})).on("beforeunload",(function(){$(t).hide()})),t}();F=g(R,L),f(),p(),o(e)}function f(){v.render(R,L)}function p(){(function(){var e,t,n,o;for(F.update(),y===b.length&&(y=0,u+=1),e=b[y],t=0;t<E.length;++t)n=e[E[t]],o=T[E[t]],void 0!==n&&void 0!==o&&(o.children[1].position.set(n.Position.x,n.Position.y,n.Position.z),o.children[1].quaternion.set(n.Rotation.x,n.Rotation.y,n.Rotation.z,n.Rotation.w),o.updateMatrix());y++,R.updateMatrixWorld})(),F.enabled&&F.update(),TWEEN.update(),f(),s=requestAnimationFrame(p)}function m(){L.aspect=a()/r(),L.updateProjectionMatrix(),v.setSize(a(),r())}function g(t,o){var a=new THREE.OrbitControls(o,e.get(0),n,"animated");return a.addEventListener("change",f),a}var h,b,y,v=t(e),w=n.aabb.max,x=4*new THREE.Vector3(w.x,w.y,w.z).length(),C=Math.max(x,c),A=void 0!==n.camera.fov?n.camera.fov:70,L=new THREE.PerspectiveCamera(A,a()/r(),l,C),R=new THREE.Scene;R.add(L);var F,T={},S=new THREE.OBJMTLLoader,E=Object.keys(n.partobjs),I=0,k=E.length;for(h=0;h<E.length;++h){var H=E[h],U=n.partobjs[H].files["scene.obj"].content,M=n.partobjs[H].files["scene.mtl"].content;function P(e){return function(t,n){return i(e,t,n)}}S.load(U,M,P(H))}b=n.frames,y=0}var o=$("#image-retry-data"),a=o?o.data("ga-logging-percent"):0,r=window.GoogleAnalyticsEvents&&GoogleAnalyticsEvents.FireEvent||function(){},i=function(e){Math.random()<=a/100&&r(e)},s=null,l=.1,c=1e3,d=[],u=0;$.fn.getNumOfLoops=function(){return u},$.fn.clearCurrentAnimationFrame=function(){u=0,cancelAnimationFrame(s)},$.fn.loadAnimatedThumbnail=function(o,a,r){function s(e,t,n,o){function r(o){if(o.realRegeneration=!0,n-- >0)o.retriesDone++,setTimeout((function(){s(e,t,n,o)}),1500);else{var a=+new Date-o.start;i(["ThumbnailGenTime","Animated","Gave Up",a]),i(["ThumbnailGenRetries","Animated","Gave Up",o.retriesDone])}}function l(e,n){var o=+new Date-n.start;e.Final?$.getJSON(e.Url,(function(e){n.realRegeneration&&(i(["ThumbnailGenTime","Animated","Success",o]),i(["ThumbnailGenRetries","Animated","Success",n.retriesDone])),t(e,n)})).fail((function(){i(["ThumbnailGenErrors","Animated","Failure",e.Url]),i(["ThumbnailGenTime","Animated","Failure",o]),i(["ThumbnailGenRetries","Animated","Failure",n.retriesDone]),a("Animated Thumbnail failed to load")})):r(n)}$.ajax({url:e+"&_="+$.now(),method:"GET",crossDomain:!0,contentType:"application/json; charset=utf-8",dataType:"json",xhrFields:{withCredentials:!0},cache:!1}).success((function(e){l(e,o)})).fail((function(){r(o)}))}var l=!1;return this.each((function(){var c,d=$(this);try{c=function(){function a(){f&&(clearTimeout(f),f=void 0),Roblox.ThumbnailSpinner.hide(d)}function c(e){var n=new MutationObserver((function(o){o.forEach((function(o){var a,r=o.removedNodes;if("childList"===o.type)for(a=0;a<r.length;++a)if(r[a]===e)return t(d).forceContextLoss(),void n.disconnect()}))}));n.observe(e.parentNode,{childList:!0})}var f,p={start:+new Date,realRegeneration:!1,retriesDone:0};(null===r||""===r)&&(r=Roblox.Endpoints.generateAbsoluteUrl(d.data("animated-asset-url"),null,!0)),r&&(e(d),f=setTimeout((function(){l||Roblox.ThumbnailSpinner.show(d)}),500),s(r,(function(t,r){u=0;var s=+new Date;n(d,t,(function(t){if(e(d),!l){a(),d.append(t),c(t);var n=+new Date-s;r.realRegeneration&&i(["ThumbnailInBrowserRenderTime","Animated","Success",n]),o(t,r)}}))}),10,p))},c()}catch(e){a(e)}})),{cancel:function(){l=!0}}}})),void 0===Roblox&&(Roblox={}),Roblox.ThumbnailView=function(){function e(e){e.find("canvas").remove()}function t(){if(null===u)try{var e=document.createElement("canvas");u=!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){u=!1}return u}function n(){return Roblox&&Roblox.LocalStorage?Roblox.LocalStorage.isAvailable():window.localStorage&&localStorage.setItem&&localStorage.getItem}function o(e,n){return!!t()&&(!!r(e)&&(!!n||p))}function a(e,o){t()||(p=!1),(r(o)||!0!==e)&&(p=e,n()&&localStorage.setItem(l,e.toString()))}function r(e){return"string"==typeof e.data("3d-thumbs-enabled")||e.hasClass("3d-thumbs-enabled")}function i(t){function n(){return t.find(".thumbnail-span")}function i(){return t.find(".thumbnail-span-original")}function s(e){return e.find("img")}function l(){return t.find(".thumbnail-holder")}function p(){return t.find(d)}function g(){return t.find(f)}function h(e,t){e.html(t.html()),e.data("url",t.data("url")?t.data("url"):""),e.data("3d-url",t.data("3d-url")?t.data("3d-url"):""),e.data("orig-retry-url",t.data("orig-retry-url")?t.data("orig-retry-url"):""),e.data("retry-url",t.data("retry-url")?t.data("retry-url"):""),e.data("animated-asset-url",t.data("animated-asset-url")?t.data("animated-asset-url"):"")}function b(){return"static"===U?"2D":P?O:G}function y(){return"static"===U?"3D":V}function v(){return Roblox.Lang.ItemResources?B?Roblox.Lang.ItemResources["Action.TakeOff"]:Roblox.Lang.ItemResources["Action.TryOn"]:B?"Take Off":"Try On"}function w(){var o=n();e(t),Roblox.ThumbnailSpinner.show(o),s(o).hide(),o.one("thumbnailLoaded",(function(){s(o).show(),Roblox.ThumbnailSpinner.hide(o)}))}function x(){P?($(d).addClass("bundle-animation-play"),p().html(P&&D.getIsLoopingThroughAnimations()?b():y())):p().html(o(l(),P)?b():y()),o(l(),P)||(r(l())?u?p().css("visibility","visible"):p().addClass("disabled"):p().css("visibility","hidden")),g().html(v())}function C(e){E=void 0,t.find("canvas").not(e).remove()}function A(){i().length>0&&(g().html(v()),h(n(),B?t.find(".thumbnail-span-try-it-on"):i()))}function L(){P?D.startAnimationLoop():T()}function R(e){return function(t,n){C(t);var o=+new Date;Roblox.ThumbnailMetrics.logFinalThumbnailTime(o-n.start,e)}}function F(e){return function(){E=void 0,p().addClass("disabled"),Roblox.ThumbnailMetrics.logThumbnailTimeout(e)}}function T(a){var r,i=o(l(),P);a||(a=n()),i?(e(t),s(a).hide(),"static"===U?E=a.load3DThumbnail(R("3dThumbnail"),F("3dThumbnail")):(E=a.clearCurrentAnimationFrame(),E=a.loadAnimatedThumbnail(R("AnimationThumbnail"),F("AnimationThumbnail"),k)),s(a).hide()):(m&&(m=!1,r=a.data("orig-retry-url"),a.data("retry-url",r)),a.data("retry-url")?(w(),a.loadRobloxThumbnails()):(e(t),Roblox.ThumbnailSpinner.hide(l()),s(a).show())),x()}function S(){var e,a,r=n();m=!0,o(l(),P)?T(r):void 0!==(e=r.data("orig-retry-url"))?(r.data("retry-url",e),T(r)):(""!==H&&l().data("url",H),(a=l().data("url"))&&t.load(a+"&_="+$.now(),(function(){T(r)})))}var E,I,k="",H="",U="static",M=$(".bundle-animation-btn-container"),P=null!==M&&M.length>0,D=P?function(){function e(){return t.find("#current-animation-name")}function o(){M.removeClass("hidden"),e().removeClass("hidden"),u=!0,w(),r(!0),clearInterval(l),l=setInterval(r,g)}function a(){clearTimeout(c),clearInterval(l),m=0,h=0}function r(t){var o,r;u?(o=n(),m+=g,(o.getNumOfLoops()>=x||t||m>C)&&(null!==d&&f>=d.length&&(h++,f=0),r=(r=g-100)>0?r:0,o.fadeOut(r),c=setTimeout((function(){i($(d[f]),!0),f+=1,m=0,o.fadeIn(500),-1!==v&&h>=v&&(a(),M.addClass("hidden"),e().addClass("hidden"),u=!1,p().html(y()))}),r))):a()}function i(t,n){var o,a=t.attr("data-animated-asset-url"),r=t.attr("data-static-url"),i=t.attr("data-three-dee-type");f=parseInt(t.attr("data-index")),o=t.attr("data-name"),e().html(o),s(r,a,i,n),$(".bundle-animation-btn.selected").removeClass("selected"),t.addClass("selected")}function s(e,t,n,o){k=t,H=e,U=n,u=o,S()}var l,c,d=$(".bundle-animation-btn"),u=!1,f=0,m=0,g=200,h=0,v=-1,x=3,C=1e4;return t.on("click",".bundle-animation-play",(function(){!$(this).hasClass("disabled")&&P&&D.clickToggleAnimationLoopButton()})),{startAnimationLoop:o,getIsLoopingThroughAnimations:function(){return u},clickToggleAnimationLoopButton:function(){u?(u=!1,p().html(u?b():y())):o()},changeThumbnailFromBundleItem:i,changeThumbnail:s}}():null,B=!1;U=l().data("3dtype")||"static",i().length>0&&h(n(),i());var V="<span class='icon-bigplay-fill'></span>",G="<span class='icon-bigstop-fill'></span>",O="<span class='icon-pause-fill'></span>";return I={container:t,holder:l,span:n,button:p,showSpinner:w,outerLoad:L,reload:S,bundleAnimationCtrl:D},t.on("click",d,(function(){$(this).hasClass("disabled")||P||function(){E&&E.cancel(),A();var e=o(l(),P);a(!e,l()),e!==o(l(),P)&&(""!==H?t.load(H+"&_="+$.now(),(function(){T()})):T())}()})).on("click",f,(function(){B=!B,A(),S()})),L(),c.push(I),I}function s(e){$(e).each((function(){i($(this).parent())}))}var l="RobloxUse3DThumbnailsV2",c=[],d=".enable-three-dee",u=null,f=".try-it-on",p=!1,m=!1;return $(".bundle-animation-btn").click((function(e){var t=$(e.currentTarget);c[0].bundleAnimationCtrl.changeThumbnailFromBundleItem(t,!1)})),n()&&("true"===localStorage.getItem(l)?p=!0:(p=!1,localStorage.setItem(l,"false"))),$((function(){s(".thumbnail-holder")})),{showSpinner:function(){return function(e){e.forEach((function(e){e.showSpinner()}))}(c)},reloadThumbnail:function(){return function(e){e.forEach((function(e){e.reload()}))}(c)},setupDelayedThumbnailHolders:function(){s(".delayed-thumbnail-holder")}}}(),(Roblox=Roblox||{}).ThumbnailSpinner=function(){var e=".thumbnail-loader";return{show:function(t){if(!(t.find(e).length>0)){var n=$('<div class="thumbnail-loader"><span class="spinner spinner-default"></span></div>');t.append(n)}},hide:function(t){t.find(e).remove()}}}(),(Roblox=Roblox||{}).Lang=Roblox.Lang||{},Roblox.Lang["Feature.Profile"]={"Action.Accept":"Accept","Action.AddFriend":"Add Friend","Action.BlockUser":"Block User","Action.CancelBlockUser":"Cancel","Action.Chat":"Chat","Action.Close":"Close","Action.ConfirmBlockUser":"Block","Action.ConfirmUnblockUser":"Unblock","Action.Favorites":"Favorites","Action.Follow":"Follow","Action.GridView":"Grid View","Action.ImpersonateUser":"Impersonate User","Action.Inventory":"Inventory","Action.JoinGame":"Join","Action.Message":"Message","Action.Pending":"Pending","Action.Save":"Save","Action.SeeAll":"See All","Action.SeeLess":"See Less","Action.SeeMore":"See More","Action.SlideshowView":"Slideshow View","Action.Trade":"Trade","Action.TradeItems":"Trade Items","Action.UnblockUser":"Unblock User","Action.Unfollow":"Unfollow","Action.Unfriend":"Unfriend","Action.UpdateStatus":"Update Status","Description.AboutSuccess":"Successfully updated description.","Description.AboutWarning":"Keep yourself safe, do not share personal details online.","Description.BlockUserFooter":"When you've blocked a user, neither of you can directly contact the other.","Description.BlockUserPrompt":"Are you sure you want to block this user?","Description.ChangeAlias":"Only you can see this information","Description.Error":"Unable to update description, please try again later.","Description.PlaceholderStatus":"Tell the Roblox community about what you like to make, build, and explore...","Description.RecognizeFriendsByCustomName":"Recognize friends more easily by setting a custom name. Names imported from contacts and custom names are only visible to you.","Description.SetCustomName":'Set a custom name for <font weight="medium">{displayName}</font>.',"Description.SetCustomName2":"Set a custom name for","Description.SetCustomNameNoDisplayName":"Set a custom name.","Description.UnblockUserPrompt":"Are you sure you want to unblock this user?","Heading.AboutTab":"About","Heading.BlockUserTitle":"Warning","Heading.Collections":"Collections","Heading.CurrentlyWearing":"Currently Wearing","Heading.FavoriteGames":"Favorites","Heading.Friends":"Friends","Heading.FriendsNum":"Friends ({friendsCount})","Heading.Games":"Experiences","Heading.GameTitle":"Experiences","Heading.Groups":"Groups","Heading.PlayerAssetsBadges":"Badges","Heading.PlayerAssetsClothing":"Clothing","Heading.PlayerAssetsModels":"Models","Heading.PlayerAssetsModelsAndPackages":"Models & Packages","Heading.PlayerBadge":"Badges","Heading.Profile":"Profile","Heading.ProfileGroups":"Groups","Heading.RobloxBadge":"Roblox Badges","Heading.Statistics":"Statistics","Label.About":"About","Label.Alias":"Alias","Label.BlockWarningBody":"Are you sure you want to block this user?","Label.BlockWarningConfirm":"Block","Label.BlockWarningFooter":"When you've blocked a user, neither of you can directly contact the other.","Label.Cancel":"Cancel","Label.ChangeAlias":"Set Alias","Label.Creations":"Creations","Label.CustomizeName":"Customize Name","Label.CustomizeNamePlaceholder":"Custom Name","Label.Followers":"Followers","Label.Following":"Following","Label.ForumPosts":"Forum Posts","Label.Friends":"Friends","Label.GridView":"Grid View","Label.JoinDate":"Join Date","Label.LoadMore":"Load More","Label.Members":"Members","Label.PastUsername":"Past Usernames","Label.PastUsernames":"Previous usernames","Label.PlaceVisits":"Place Visits","Label.Playing":"Active","Label.QRCodeFriendRequest":"Sent from your QR code","Label.Quotation":'"{userStatus}"',"Label.Rank":"Rank","Label.ReadMore":"Read More","Label.ReportAbuse":"Report Abuse","Label.ShowLess":"Show Less","Label.SlideshowView":"Slideshow View","Label.UnblockWarningBody":"Are you sure you want to unblock this user?","Label.UnblockWarningConfirm":"Unblock","Label.Visits":"Visits","Label.WarningTitle":"Warning","Message.AcceptFriendRequestError":"Unable to accept friend request.","Message.AliasHasError":"An error has occurred. Please try again later","Message.AliasIsModerated":"Please avoid using full names or offensive language.","Message.BlockError":"Unable to block user. You may have blocked too many people.","Message.BlockRequestError":"Unable to block user.","Message.ChangeStatus":"What are you up to?","Message.ErrorBlockLimit":"Operation failed! You may have blocked too many people.","Message.ErrorGeneral":"Something went wrong. Please check back in a few minutes.","Message.FollowError":"Unable to follow user.","Message.ImpersonateUserError":"Unable to impersonate user.","Message.InvalidAliasError":"Name cannot be saved. Try another name.","Message.NoCreation":"{username} has no creations.","Message.RemoveFriendError":"Unable to unfriend user.","Message.SendFriendRequestError":"Unable to send friend request.","Message.Sharing":"Sharing...","Message.UnfollowError":"Unable to unfollow user.","Message.UpdateStatusError":"Unable to update status.","Response.TooManyAttempts":"Too many attempts. Please try again later.",SetCustomName2:"Set a custom name for"},Roblox.Lang.ProfileResources=Roblox.Lang["Feature.Profile"];var profile=angular.module("profile",["modal","thumbnails","captchaV2","presence"]).config(["languageResourceProvider",function(e){var t=Roblox.Lang.ProfileResources||{},n={"Message.AcceptFriendRequestError":t&&t["Message.AcceptFriendRequestError"]||"Unable to accept friend request.","Message.SendFriendRequestError":t&&t["Message.SendFriendRequestError"]||"Unable to send friend request.","Message.RemoveFriendError":t&&t["Message.RemoveFriendError"]||"Unable to unfriend user.","Message.FollowError":t&&t["Message.FollowError"]||"Unable to follow user.","Message.UnfollowError":t&&t["Message.UnfollowError"]||"Unable to unfollow user.","Message.BlockError":t&&t["Message.BlockError"]||"Unable to block user. You may have blocked too many people.","Message.BlockRequestError":t&&t["Message.BlockRequestError"]||"Unable to block user.","Message.ImpersonateUserError":t&&t["Message.ImpersonateUserError"]||"Unable to impersonate user.","Message.UpdateStatusError":t&&t["Message.UpdateStatusError"]||"Unable to update status."};e.setLanguageKeysFromFile(Roblox.Lang.ItemResources||{}),e.setLanguageKeysFromFile(t),e.setLanguageKeysFromFile(n)}]);function InitStringTruncator(){isInitialized||((fitStringSpan=document.createElement("span")).style.display="inline-block",fitStringSpan.style.visibility="hidden",fitStringSpan.style.height="0px",fitStringSpan.style.padding="0px",document.body.appendChild(fitStringSpan),isInitialized=!0)}function fitStringToWidth(e,t,n){function o(e){return e.replace("<","&lt;").replace(">","&gt;")}var a,r,i,s,l;if(isInitialized||InitStringTruncator(),n&&(fitStringSpan.className=n),a=o(e),fitStringSpan.innerHTML=a,fitStringSpan.offsetWidth>t){for(r=0,s=e.length;l=s-r>>1;)i=r+l,fitStringSpan.innerHTML=o(e.substring(0,i))+"&hellip;",fitStringSpan.offsetWidth>t?s=i:r=i;a=e.substring(0,r)+"&hellip;"}return a}function fitStringToWidthSafe(e,t,n){var o,a=fitStringToWidth(e,t,n);return-1!=a.indexOf("&hellip;")&&(-1!=(o=a.lastIndexOf(" "))&&o+10<=a.length&&(a=a.substring(0,o+2)+"&hellip;")),a}function fitStringToWidthSafeText(e,t,n){return fitStringToWidthSafe(e,t,n).replace("&hellip;","...")}profile.factory("profileUtilitiesConstantsServices",["languageResource",function(e){return{layout:{linkName:e.get("Action.SeeMore"),nameOfOpen:e.get("Action.SeeMore"),nameOfClose:e.get("Action.SeeLess")},userModal:{block:{titleText:e.get("Heading.BlockUserTitle"),bodyText:e.get("Description.BlockUserPrompt"),actionButtonText:e.get("Action.ConfirmBlockUser"),neutralButtonText:e.get("Action.CancelBlockUser"),footerText:e.get("Description.BlockUserFooter")},unblock:{titleText:e.get("Heading.BlockUserTitle"),bodyText:e.get("Description.UnblockUserPrompt"),actionButtonText:e.get("Action.ConfirmUnblockUser"),neutralButtonText:e.get("Action.CancelBlockUser")},error:{blockLimitError:e.get("Message.ErrorBlockLimit"),generalError:e.get("Message.ErrorGeneral")},menu:{blockUserText:e.get("Action.BlockUser"),unblockUserText:e.get("Action.UnblockUser")},pastUsername:{titleText:e.get("Label.PastUsername"),neutralButtonShow:!1}},message:{acceptFriendRequestFailed:e.get("Message.AcceptFriendRequestError"),sendFriendRequestFailed:e.get("Message.SendFriendRequestError"),removeFriendFailed:e.get("Message.RemoveFriendError"),followFailed:e.get("Message.FollowError"),unfollowFailed:e.get("Message.UnfollowError"),blockFailed:e.get("Message.BlockError"),blockRequestFailed:e.get("Message.BlockRequestError"),impersonateUserFailed:e.get("Message.ImpersonateUserError"),updateStatusFailed:e.get("Message.UpdateStatusError"),tooManyAttempts:e.get("Response.TooManyAttempts")},errorCodes:{captchaNeeded:14}}}]),profile.factory("profileService",["httpService","$rootScope","$timeout","$window","$filter","localStorageService",function(e,t,n,o,a,r){var i={},s=function(t,n){var o={url:Roblox.EnvironmentUrls.friendsApi+t};return function(){var e,t,n,o,a,i,s;if(r.storage()){for(e=[Roblox.EnvironmentUrls.friendsApi,Roblox.EnvironmentUrls.presenceApi],t=[],n=0;n<r.getLength();n++)for(o=r.getKey(n),a=0;a<e.length;a++)i=e[a],o.indexOf(i)>-1&&t.push(o);for(s=0;s<t.length;s++)r.removeLocalStorage(t[s])}}(),e.httpPost(o,n)},l={accountDescription:Roblox.EnvironmentUrls.accountInformationApi+"/v1/description"};return{acceptFriendRequestV2:function(e){return s("/v1/users/"+e+"/accept-friend-request")},sendFriendRequestV2:function(e,t){var n=null;return t&&(n={friendshipOriginSourceType:t}),s("/v1/users/"+e+"/request-friendship",n)},removeFriendV2:function(e){return s("/v1/users/"+e+"/unfriend")},followV2:function(e,t){return s("/v1/users/"+e+"/follow",t)},unfollowV2:function(e){return s("/v1/users/"+e+"/unfollow")},toggleBlockUser:function(t,n){var o;return o=t?{url:Roblox.EnvironmentUrls.accountSettingsApi+"/v1/users/"+n+"/unblock"}:{url:Roblox.EnvironmentUrls.accountSettingsApi+"/v1/users/"+n+"/block"},e.httpPost(o)},impersonateUser:function(t){var n={url:Roblox.EnvironmentUrls.authApi+"/v2/users/"+t+"/impersonate"};return e.httpPost(n,{})},updateStatus:function(t,n){var o={url:t,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}},a={status:n,sendToFacebook:!1};return a=$.param(a),e.httpPost(o,a)},setAccountInformationUrl:function(e){l.accountDescription=e+"/v1/description"},getFriendshipCountV2:function(t){var n={url:Roblox.EnvironmentUrls.friendsApi+"/v1/users/"+t+"/friends/count",withCredentials:!0,retryable:!0};return e.httpGet(n)},getCollections:function(t,n){var o={url:t},a={userId:n};return e.httpGet(o,a)},getPlayerAssets:function(t,n,o){var a={url:t},r={assetTypeId:o,userId:n};return e.httpGet(a,r)},getPresence:function(t){var n={url:Roblox.EnvironmentUrls.presenceApi+"/v1/presence/users",withCredentials:!0,retryable:!0},o={userIds:[t]};return e.httpPost(n,o)},getPlayabilityStatus:function(t){var n={url:Roblox.EnvironmentUrls.gamesApi+"/v1/games/multiget-playability-status?universeIds="+t,withCredentials:!0,retryable:!0};return e.httpGet(n)},setProfileData:function(e){i=e,this._onLoad&&this._onLoad(i)},onLoad:function(e){this._onLoad=e},getProfileData:function(){return i},refreshLazyLoadImage:function(){n((function(){t.$emit("lazyImg:refresh")}))},getUpdatedHeaderData:function(t,n){var o={url:t},a={userId:n};return e.httpGet(o,a)}}}]),profile.filter("statusfilter",(function(){return function(e){return e?'"'+e+'"':""}})),profile.constant("profileJsonEndPoints",{collections:"/users/profile/robloxcollections-json",playerAssets:"/users/profile/playerassets-json",profileHeaderData:"/users/profile/profileheader-json"}),profile.constant("profileFriendEvents",{playerFriendAdd:"playerFriendAdd",playerFriendAccept:"playerFriendAccept",eventCtx:"userProfile"}),profile.controller("profileBaseController",["$log","$scope",function(e,t){t.appMeta={isI18nEnabled:Roblox.I18nData&&Roblox.I18nData.isI18nEnabledForGroups}}]),profile.controller("profileUtilitiesController",["$log","$scope","modalService","profileService","profileJsonEndPoints","profileUtilitiesConstantsServices",function(e,t,n,o,a,r){t.layoutContent={showMore:!0,linkName:r.layout.linkName,nameOfOpen:r.layout.nameOfOpen,nameOfClose:r.layout.nameOfClose},t.toggleContent=function(e){t.layoutContent.showMore=!e,t.layoutContent.linkName=e?t.layoutContent.nameOfClose:t.layoutContent.nameOfOpen},t.loadMore=function(){t.layoutContent.showMore=!1},t.showPastUsernames=function(){var e=r.userModal.pastUsername;e.bodyText=t.pageData.previousUsernames,n.open(e)},t.initializeDescription=function(){o.getDescription().then((function(e){t.data.description=e.description,t.layout.showEditBox=!!t.isDescriptionEmpty(),t.layout.showEditButton=!t.isDescriptionEmpty()}),(function(){e.debug("Error getting personal description")}))},t.updateDescription=function(){o.updateDescription(t.data.description).then((function(e){t.data.description=e.description,t.layout.showEditButton=!0,t.layout.showEditBox=!1}),(function(n){e.debug("Error updating personal description"),t.layout.descriptionError=n.message}))},t.openEditBox=function(){t.layout.showEditButton=!1,t.layout.showEditBox=!0},t.isDescriptionEmpty=function(){return null==t.data.description||0===t.data.description.length},t.getPlayerAssets=function(n){var r=a.playerAssets;return o.getPlayerAssets(r,t.pageData.profileUserId,n).then((function(n){e.debug("my player assets: ",n),t.assets=n.Assets,t.data.title=n.Title,t.data.assetUrl=n.AssetTypeInventoryUrl,t.layout.showSeeAllButton=n.IsSeeAllHeaderButtonVisible,t.isProfileAssetAttributionEnabled=!!n.IsProfileAssetAttributionEnabled,o.refreshLazyLoadImage()}))},t.init=function(){t.layout||(t.layout={showSeeAllButton:!1},t.data={title:"",assetUrl:"",description:""},t.pageData=o.getProfileData(),t.assets=[])},t.init()}]),profile.controller("profileHeaderController",["$scope","profileService","realtimeService","chatDispatchService","$document","$log","$filter","modalService","profileUtilitiesConstantsServices","profileJsonEndPoints","profileFriendEvents","httpStatusCodes","thumbnailConstants","captchaV2Constants","urlService",function(e,t,n,o,a,r,i,s,l,c,d,u,f,p,m){var g="#profile-header-more",h="#profile-header-update-status";e.thumbnailTypes=f.thumbnailTypes;var b=Roblox&&Roblox.Endpoints?Roblox.Endpoints.getAbsoluteUrl("/Login/Signup.aspx"):"/Login/Signup.aspx",y=Roblox&&Roblox.Endpoints?Roblox.Endpoints.getAbsoluteUrl("/Home"):"/Home",v=function(e){return e&&e.EventArgs};e.profileHeaderLayout={},e.presence={userPresenceType:0,lastLocation:"Website",rootPlaceId:null},e.updateMessageBtnDisplay=function(){var n=c.profileHeaderData;t.getUpdatedHeaderData(n,e.profileHeaderLayout.profileUserId).then((function(t){t&&(e.profileHeaderLayout.canMessage=t.CanMessage,e.profileHeaderLayout.messagesDisabled=t.MessagesDisabled),e.setMessageBtnDisplay(e.profileHeaderLayout)}),(function(){e.setMessageBtnDisplay(e.profileHeaderLayout)}))},e.captcha={actionTypes:p.captchaActionTypes,activated:!1,inputParams:{unifiedCaptchaId:"",dataExchange:""}},e.setMessageBtnDisplay=function(e){if(e){var t=e.canMessage&&e.userId>0;e.enableMessageBtn=t,e.isChatDisabledByPrivacySetting?(e.showMessageBtn=!0,e.showMessageLink=!1,e.showChatBtn=!1):(e.showMessageBtn=!e.areFriends,e.showMessageLink=t&&e.areFriends,e.showChatBtn=e.userId>0&&e.areFriends),!0===e.messagesDisabled&&(e.showMessageBtn=!1,e.showMessageLink=!1)}},e.acceptFriendRequest=function(){e.profileHeaderLayout.userId?t.acceptFriendRequestV2(e.profileHeaderLayout.profileUserId).then((function(){e.updateLayoutByAcceptingFR(),e.firePlayerFriendAcceptEvent()}),(function(t){var n=e.parseErrorFromApiResponse(t),o=n&&n.userFacingMessage?n.userFacingMessage:l.message.acceptFriendRequestFailed;e.displayError(o)})):window.location=b},e.updateLayoutBySendingFRFromMyself=function(){e.profileHeaderLayout.maySendFriendInvitation=!1,e.profileHeaderLayout.friendRequestPending=!0},e.sendFriendRequest=function(){e.profileHeaderLayout.userId?t.sendFriendRequestV2(e.profileHeaderLayout.profileUserId,m.getParam("friendshipSourceType")).then((function(t){r.debug(t),e.updateLayoutBySendingFRFromMyself(),e.firePlayerFriendAddEvent(),a.triggerHandler("Roblox.Friendship.FriendRequestSent")}),(function(t){var n=e.parseErrorFromApiResponse(t),o=l.message.sendFriendRequestFailed;t.status===u.tooManyAttempts?o=l.message.tooManyAttempts:n&&n.userFacingMessage&&(o=n.userFacingMessage),e.displayError(o)})):window.location=b},e.firePlayerFriendAddEvent=function(){var t=Roblox.EventStream;t&&t.SendEventWithTarget(d.playerFriendAdd,d.eventCtx,{uid:e.profileHeaderLayout.userId,playerId:e.profileHeaderLayout.profileUserId},t.TargetTypes.WWW)},e.firePlayerFriendAcceptEvent=function(){var t=Roblox.EventStream;t&&t.SendEventWithTarget(d.playerFriendAccept,d.eventCtx,{uid:e.profileHeaderLayout.userId,playerId:e.profileHeaderLayout.profileUserId},t.TargetTypes.WWW)},e.updateFriendshipCount=function(){t.getFriendshipCountV2(e.profileHeaderLayout.profileUserId).then((function(t){e.profileHeaderLayout.friendsCount=t.count}))},e.updateLayoutByAcceptingFR=function(){e.profileHeaderLayout.areFriends||(e.profileHeaderLayout.incomingFriendRequestPending=!1,e.profileHeaderLayout.friendRequestPending=!1,e.profileHeaderLayout.areFriends=!0,e.updateFriendshipCount(),e.updateMessageBtnDisplay(),e.refreshPresence(e.profileHeaderLayout.profileUserId))},e.callbackForAcceptingFriendRequest=function(t){if(!v(t))return!1;e.$evalAsync((function(){var n=parseInt(t.EventArgs.UserId1),o=parseInt(t.EventArgs.UserId2),a=parseInt(e.profileHeaderLayout.profileUserId),r=parseInt(e.profileHeaderLayout.userId);n===r&&o===a&&e.updateLayoutByAcceptingFR(),o===r&&n===a&&(e.profileHeaderLayout.incomingFriendRequestPending=!1,e.profileHeaderLayout.areFriends=!0,e.refreshPresence(e.profileHeaderLayout.profileUserId))}))},e.updateLayoutByRemovingFriendRequest=function(t){e.$evalAsync((function(){if(v(t)&&parseInt(t.EventArgs.UserId2)!==parseInt(e.profileHeaderLayout.profileUserId))return!1;e.profileHeaderLayout.areFriends&&(e.profileHeaderLayout.maySendFriendInvitation=!0,e.profileHeaderLayout.originalMaySendFriendInvitation=e.profileHeaderLayout.maySendFriendInvitation,e.profileHeaderLayout.areFriends=!1,e.updateFriendshipCount(),e.updateMessageBtnDisplay(),e.refreshPresence(e.profileHeaderLayout.profileUserId))}))},e.updateLayoutByDecliningFriendRequest=function(){e.$evalAsync((function(){e.profileHeaderLayout.maySendFriendInvitation=!0,e.profileHeaderLayout.originalMaySendFriendInvitation=e.profileHeaderLayout.maySendFriendInvitation,e.profileHeaderLayout.areFriends=!1}))},e.callbackForSendingFriendRequest=function(t){if(!v(t))return!1;e.$evalAsync((function(){var n=parseInt(t.EventArgs.UserId1),o=parseInt(t.EventArgs.UserId2),a=parseInt(e.profileHeaderLayout.profileUserId),r=parseInt(e.profileHeaderLayout.userId);n===a?(e.profileHeaderLayout.incomingFriendRequestPending=!0,e.profileHeaderLayout.friendRequestPending=!1,e.profileHeaderLayout.areFriends=!1):n===r&&o===a&&e.updateLayoutBySendingFRFromMyself()}))},e.removeFriend=function(){e.profileHeaderLayout.userId?t.removeFriendV2(e.profileHeaderLayout.profileUserId).then((function(){e.updateLayoutByRemovingFriendRequest()}),(function(t){var n=e.parseErrorFromApiResponse(t),o=n&&n.userFacingMessage?n.userFacingMessage:l.message.removeFriendFailed;e.displayError(o)})):window.location=b},e.checkIsFollowing=function(){e.profileHeaderLayout.isFollowing?e.unFollow():e.follow()},e.follow=function(){e.profileHeaderLayout.userId?e.sendFollow():window.location=b},e.sendFollow=function(n){t.followV2(e.profileHeaderLayout.profileUserId,n).then((function(t){t.success&&(e.profileHeaderLayout.isFollowing=!0,e.incrementFollowers(1))}),(function(t){var n=e.parseErrorFromApiResponse(t),o=l.message.followFailed;if(t&&t.status===u.tooManyAttempts)o=l.message.tooManyAttempts;else{if(n&&n.code===l.errorCodes.captchaNeeded)return void e.activateCaptcha(n);n&&n.userFacingMessage&&(o=n.userFacingMessage)}e.displayError(o)}))},e.activateCaptcha=function(t){var n,o,a=t.fieldData,r="";if(null!=a){try{n=(o=JSON.parse(a)).dxBlob,r=o.unifiedCaptchaId}catch(e){n=a}e.captcha.inputParams.unifiedCaptchaId=r,e.captcha.inputParams.dataExchange=n}e.captcha.activated=!0},e.followUserCaptchaPassed=function(t){e.sendFollow(t)},e.followUserCaptchaFailed=function(){e.captcha.activated=!1},e.incrementFollowers=function(t){null!=e.profileHeaderLayout.followersCount&&(e.profileHeaderLayout.followersCount=e.profileHeaderLayout.followersCount+t)},e.displayError=function(t){e.profileHeaderLayout.errorMsg=t,e.profileHeaderLayout.hasError=!0},e.clearError=function(){e.profileHeaderLayout.errorMsg="",e.profileHeaderLayout.hasError=!1,e.profileHeaderLayout.statusError=null},e.parseErrorFromApiResponse=function(e){return e&&e.errors&&e.errors[0]},e.unFollow=function(){e.profileHeaderLayout.userId?t.unfollowV2(e.profileHeaderLayout.profileUserId).then((function(){e.profileHeaderLayout.isFollowing=!1,e.incrementFollowers(-1)}),(function(t){var n=e.parseErrorFromApiResponse(t),o=n&&n.userFacingMessage?n.userFacingMessage:l.message.unfollowFailed;e.displayError(o)})):window.location=b},e.sendMessage=function(){window.location=e.profileHeaderLayout.userId?e.profileHeaderLayout.messageUrl:b},e.chat=function(){var t=e.profileHeaderLayout.profileUserId,n=o.buildPermissionVerifier(e.profileHeaderLayout);o.startChat(t,n)},angular.element(g).on("click touchstart","#profile-trade-items",(function(){var t=e.profileHeaderLayout.profileUserId;Roblox.EventStream.SendEvent("tradeEntryPoint","profileMenu",{partnerId:t}),window.location.href=Roblox.Endpoints.getAbsoluteUrl("/users/"+t+"/trade")})),e.blockUser=function(){var n,o,a;angular.element(document.querySelector("body")).click(),(o=(n=l.userModal).block).actionButtonShow=!0,(a=n.unblock).actionButtonShow=!0;n.error.blockLimitError;var i=n.error.generalError,c=n.menu.blockUserText,d=n.menu.unblockUserText,u=e.profileHeaderLayout.isVieweeBlocked?a:o;s.open(u).result.then((function(){t.toggleBlockUser(e.profileHeaderLayout.isVieweeBlocked,e.profileHeaderLayout.profileUserId).then((function(){var t,n=e.profileHeaderLayout.isVieweeBlocked;n?(e.profileHeaderLayout.maySendFriendInvitation=e.profileHeaderLayout.originalMaySendFriendInvitation,e.profileHeaderLayout.mayFollow=e.profileHeaderLayout.originalMayFollow,e.setMessageBtnDisplay(e.profileHeaderLayout),e.profileHeaderLayout.canTrade=e.profileHeaderLayout.originalCanTrade):(e.profileHeaderLayout.maySendFriendInvitation=!1,e.profileHeaderLayout.incomingFriendRequestPending=!1,e.profileHeaderLayout.friendRequestPending=!1,e.profileHeaderLayout.mayFollow=!1,e.profileHeaderLayout.enableMessageBtn=!1,e.profileHeaderLayout.canTrade=!1),e.profileHeaderLayout.isVieweeBlocked=!n,t=e.profileHeaderLayout.isVieweeBlocked?c:d,angular.element("#profile-block-user").text(t)}),(function(t){r.error("Failed to toggle block user.",t),e.displayError(t?t.errors[0].userFacingMessage:i)}))}),(function(){r.debug("Modal dismissed at: "+new Date)}))},e.impersonateUser=function(){t.impersonateUser(e.profileHeaderLayout.profileUserId).then((function(){window.location=y}),(function(t){var n=t&&t.errors&&t.errors[0]&&t.errors[0].message;e.displayError(n||l.message.impersonateUserFailed)}))},e.revealStatusForm=function(){},e.isUserStatusDisabled=function(){return!0},e.updateStatus=function(n){n?(e.$evalAsync((function(){e.profileHeaderLayout.statusFormSending=!0})),t.updateStatus(e.profileHeaderLayout.updateStatusUrl,e.sanitizeStatus(e.profileHeaderLayout.statusTextInput)).then((function(t){t&&t.success?(e.profileHeaderLayout.statusFormShown=!1,e.clearError(),e.profileHeaderLayout.statusInputFocused=!1,e.profileHeaderLayout.statusText=t.message):e.profileHeaderLayout.statusError=t.message||l.message.updateStatusFailed,e.profileHeaderLayout.statusFormSending=!1}),(function(){e.profileHeaderLayout.statusError=l.message.updateStatusFailed,e.profileHeaderLayout.statusFormSending=!1}))):e.$evalAsync((function(){e.profileHeaderLayout.statusFormShown=!1,e.profileHeaderLayout.statusFormSending=!1,e.profileHeaderLayout.statusInputFocused=!1,e.clearError()}))},e.refreshPresence=function(n){t.getPresence(n).then((function(t){t&&t.userPresences&&1===t.userPresences.length&&e.$evalAsync((function(){e.presence=t.userPresences[0],null!==e.placeId&&(e.presence.placeUrl=e.getUrlForPlaceId(e.presence.placeId)),e.updateCanBeFollowed()}))}))},e.updatePresence=function(t){var n,o;if(t.detail)for(n=0;n<t.detail.length;n++)(o=t.detail[n]).userId==e.profileHeaderLayout.profileUserId&&e.$evalAsync((function(){e.presence=o,null!==e.placeId&&(e.presence.placeUrl=e.getUrlForPlaceId(e.presence.placeId)),e.updateCanBeFollowed()}))},e.updateCanBeFollowed=function(){2===e.presence.userPresenceType&&e.presence.gameId&&t.getPlayabilityStatus(e.presence.universeId).then((function(t){t&&1===t.length&&e.$evalAsync((function(){e.profileHeaderLayout.canBeFollowed=t[0].isPlayable}))})),e.$evalAsync((function(){e.profileHeaderLayout.canBeFollowed=!1}))},e.getUrlForPlaceId=function(e){return Roblox.EnvironmentUrls.websiteUrl+"/games/"+e},e.blurStatusForm=function(t){if(t&&void 0!==t.target){var n=t.target,o="#"+n.getAttribute("id");if(null!=n.getAttribute("id")&&o==h||"#userStatusText"==o)return}e.updateStatus(!1)},e.sanitizeStatus=function(e){return e.replace(/}|{/gi,"")},e.getAbbreviatedStringFromCountValue=function(e){return e||0===e?i("abbreviate")(e):"?"},e.getStringFromCountValue=function(e){return e||0===e?e.toString():"?"},function(){var t=[],o=n.notificationTypes.friendshipNotifications;t[o.friendshipCreated]=e.callbackForAcceptingFriendRequest,t[o.friendshipDestroyed]=e.updateLayoutByRemovingFriendRequest,t[o.friendshipDeclined]=e.updateLayoutByDecliningFriendRequest,t[o.friendshipRequested]=e.callbackForSendingFriendRequest,n.listenToNotification(n.realTimeTypes.friendshipNotifications,t)}(),t.onLoad((function(t){t.angularPresenceStatusEnabled&&(e.refreshPresence(t.profileUserId),document.addEventListener("Roblox.Presence.Update",e.updatePresence))})),angular.element(g).on("click touchstart",h,(function(){e.revealStatusForm()})),angular.element(a).on("click touchstart",(function(t){for(var n=document.querySelectorAll("#statusForm"),o=0;o<n.length;o++)if(n[o].contains(t.target))return;e.blurStatusForm(t)}))}]),profile.controller("profileCollectionsController",["$scope","$log","profileService","profileJsonEndPoints",function(e,t,n,o){e.onClickTradeLink=function(){Roblox.EventStream.SendEvent("tradeEntryPoint","profileInventory",{partnerId:e.pageData.profileUserId})},e.collections=[],e.pageData=n.getProfileData(),e.getCollectionsData=function(){var a=o.collections;return n.getCollections(a,e.pageData.profileUserId).then((function(o){t.debug("my collections: ",o),e.collections=o.CollectionsItems,n.refreshLazyLoadImage()}))}}]),profile.controller("profileGridController",["$scope",function(e){e.NumberOfVisibleRows=0,e.isGridOn=!1,e.visibleItems=0,e.containerHeight=232*e.NumberOfVisibleRows+8*(e.NumberOfVisibleRows-1),e.elementClassName="",e.containerClassName="",e.elementWidthWithPadding=160,e.init=function(t,n){e.elementClassName=t,e.containerClassName=n,e.loadMore(),e.loadMore()},e.loadMore=function(){var t=e.visibleItems,n=6*(e.NumberOfVisibleRows+1),o=angular.element.find("."+e.elementClassName);e.showImages(t,n,o),e.NumberOfVisibleRows++,e.visibleItems=n},e.showImages=function(t,n,o){for(var a,r=t;r<n;r++)a=angular.element(o).find("."+e.containerClassName+"[data-index="+r+"] img"),angular.element(a).attr("src")||angular.element(a).attr("src",angular.element(a).attr("data-src"))},e.updateDisplay=function(t){e.isGridOn=t}}]),profile.directive("profileHeaderData",["profileService",function(e){return{restrict:"A",scope:{profileHeaderLayout:"=",setMessageBtnDisplay:"&"},link:function(t,n,o){var a=Roblox.DeviceMeta(),r={userId:Roblox.CurrentUser.userId,profileUserId:o.profileuserid,profileUserName:Roblox.ProfileHeaderData.profileusername,friendsCount:Number.parseInt(o.friendscount,10),followersCount:Number.parseInt(o.followerscount,10),followingsCount:Number.parseInt(o.followingscount,10),areFriends:"true"===o.arefriends,friendRequestPending:"true"===o.friendrequestpending,friendUrl:o.friendurl,incomingFriendRequestPending:"true"===o.incomingfriendrequestpending,originalMaySendFriendInvitation:"true"===o.maysendfriendinvitation,maySendFriendInvitation:"true"===o.maysendfriendinvitation,originalMayFollow:"true"===o.mayfollow,mayFollow:"true"===o.mayfollow,isFollowing:"true"===o.isfollowing,canMessage:"true"===o.canmessage,messagesDisabled:"true"===o.messagesdisabled,messageUrl:o.messageurl,canBeFollowed:"true"===o.canbefollowed,originalCanTrade:"true"===o.cantrade,canTrade:"true"===o.cantrade,isBlockButtonVisible:"true"===o.isblockbuttonvisible,isVieweeBlocked:"true"===o.isvieweeblocked,getFollowScript:o.getfollowscript,isMoreBtnVisible:"true"===o.ismorebtnvisible,mayImpersonate:"true"===o.mayimpersonate,mayUpdateStatus:!1,updateStatusUrl:o.updatestatusurl,statusText:o.statustext,statusDate:o.statusdate,editStatusMaxLength:o.editstatusmaxlength,inApp:a.isInApp,inAndroidApp:a.isAndroidApp,iniOSApp:a.isIosApp,isChatDisabledByPrivacySetting:"true"===o.ischatdisabledbyprivacysetting,previousUsernames:Roblox.ProfileHeaderData.previoususernames,angularPresenceStatusEnabled:"true"===o.angularpresencestatusenabled};t.profileHeaderLayout=r,e.setProfileData(r),t.setMessageBtnDisplay({layout:t.profileHeaderLayout}),Roblox&&Roblox.Performance&&Roblox.Performance.setPerformanceMark("header_data")}}}]),profile.directive("truncate",(function(){return{scope:{layoutContent:"="},link:function(e,t){if(e.layoutContent||(e.layoutContent={}),e.layoutContent.hasMoreContent=!1,t.find("li")&&t.find("li").length>0){var n=t.find("li").length,o=t.find("li").width();Math.floor(t.width()/o)+1<n&&(e.layoutContent.hasMoreContent=!0)}}}})),profile.directive("profileEmptyTab",(function(){return{restrict:"AC",link:function(e,t){e.profileLayout=e.profileLayout||{},0===t.children().length&&(e.profileLayout.userHasNoCreations=!0)}}})),profile.directive("statusInputElement",["$timeout",function(e){return{link:function(t,n){t.$watch((function(){return t.profileHeaderLayout.statusInputFocused}),(function(t){!0===t&&e((function(){n[0].focus()}))})),n.on("focus",(function(){var n=this;t.profileHeaderLayout.focusedElement!=n&&(t.profileHeaderLayout.focusedElement=n,e((function(){n.select()}),10))})),n.on("blur",(function(){t.profileHeaderLayout.focusedElement=null,t.profileHeaderLayout.statusInputFocused=!1}))}}}]),profile.directive("profileTabClick",["profileService",function(e){return{restrict:"A",link:function(t,n){n.find(".rbx-tab").click((function(){e.refreshLazyLoadImage()}))}}}]),profile.directive("horizontalScrollBar",(function(){return{restrict:"A",link:function(e,t,n){var o=t[0];t.bind("scroll",(function(){o.scrollLeft+o.offsetWidth>o.scrollWidth-100&&e.$apply(n.horizontalScrollBar)}))}}})),void 0===window.console&&(window.console={}),void 0===window.console.emulated&&("function"==typeof window.console.log?window.console.hasLog=!0:(void 0===window.console.log&&(window.console.log=function(){}),window.console.hasLog=!1),"function"==typeof window.console.debug?window.console.hasDebug=!0:(void 0===window.console.debug&&(window.console.debug=window.console.hasLog?function(){for(var e=["console.debug:"],t=0;t<arguments.length;t++)e.push(arguments[t]);window.console.log.apply(window.console,e)}:function(){}),window.console.hasDebug=!1),"function"==typeof window.console.warn?window.console.hasWarn=!0:(void 0===window.console.warn&&(window.console.warn=window.console.hasLog?function(){for(var e=["console.warn:"],t=0;t<arguments.length;t++)e.push(arguments[t]);window.console.log.apply(window.console,e)}:function(){}),window.console.hasWarn=!1),"function"==typeof window.console.error?window.console.hasError=!0:(void 0===window.console.error&&(window.console.error=function(){var e,t,n="An error has occured.";if(window.console.hasLog){for(e=["console.error:"],t=0;t<arguments.length;t++)e.push(arguments[t]);window.console.log.apply(window.console,e),n="An error has occured. More information is available in your browser's javascript console."}for(t=0;t<arguments.length&&"string"==typeof arguments[t];++t)n+="\n"+arguments[t];throw"undefined"!=typeof Error?new Error(n):n}),window.console.hasError=!1),"function"==typeof window.console.trace?window.console.hasTrace=!0:(void 0===window.console.trace&&(window.console.trace=function(){window.console.error("console.trace does not exist")}),window.console.hasTrace=!1),window.console.emulated=!0),function(e){e.History?window.console.warn("$.History has already been defined..."):(e.History={options:{debug:!1},state:"",$window:null,$iframe:null,handlers:{generic:[],specific:{}},extractHash:function(e){return e.replace(/^[^#]*#/,"").replace(/^#+|#+$/,"")},getState:function(){return e.History.state},setState:function(t){var n=e.History;return t=n.extractHash(t),n.state=t},getHash:function(){return e.History.extractHash(window.location.hash||location.hash)},setHash:function(t){return t=e.History.extractHash(t),void 0!==window.location.hash?window.location.hash!==t&&(window.location.hash=t):location.hash!==t&&(location.hash=t),t},go:function(t){var n,o,a=e.History;return t=a.extractHash(t),n=a.getHash(),o=a.getState(),t!==n?a.setHash(t):(t!==o&&a.setState(t),a.trigger()),!0},hashchange:function(){var t=e.History,n=t.getHash();return t.go(n),!0},bind:function(t,n){var o=e.History;return n?(void 0===o.handlers.specific[t]&&(o.handlers.specific[t]=[]),o.handlers.specific[t].push(n)):(n=t,o.handlers.generic.push(n)),!0},trigger:function(t){var n,o,a,r=e.History;if(void 0===t&&(t=r.getState()),void 0!==r.handlers.specific[t])for(n=0,o=(a=r.handlers.specific[t]).length;n<o;++n)(0,a[n])(t);for(n=0,o=(a=r.handlers.generic).length;n<o;++n)(0,a[n])(t);return!0},construct:function(){var t=e.History;return e(document).ready((function(){t.domReady()})),!0},configure:function(t){var n=e.History;return n.options=e.extend(n.options,t),!0},domReadied:!1,domReady:function(){var t=e.History;if(!t.domRedied)return t.domRedied=!0,t.$window=e(window),t.$window.bind("hashchange",this.hashchange),setTimeout(t.hashchangeLoader,200),!0},nativeSupport:function(t){var n=(t=t||e.browser).version,o=parseInt(n,10),a=n.split(/[^0-9]/g),r=parseInt(a[0],10),i=parseInt(a[1],10),s=parseInt(a[2],10),l=!1;return t.msie&&o>=8||t.webkit&&o>=528?l=!0:t.mozilla?(r>1||1===r&&(i>9||9===i&&s>=2))&&(l=!0):!!t.opera&&((r>10||10===r&&i>=60)&&(l=!0)),l},hashchangeLoader:function(){var t,n,o=e.History;return o.nativeSupport()?o.getHash()&&o.$window.trigger("hashchange"):(e.browser.msie?(o.$iframe=e('<iframe id="jquery-history-iframe" style="display: none;"></$iframe>').prependTo(document.body)[0],o.$iframe.contentWindow.document.open(),o.$iframe.contentWindow.document.close(),n=!1,t=function(){var e=o.getHash(),t=o.getState(),a=o.extractHash(o.$iframe.contentWindow.document.location.hash);t!==e?(n||(o.$iframe.contentWindow.document.open(),o.$iframe.contentWindow.document.close(),o.$iframe.contentWindow.document.location.hash=e),n=!1,o.$window.trigger("hashchange")):t!==a&&(n=!0,o.setHash(a))}):t=function(){var e=o.getHash();o.getState()!==e&&o.$window.trigger("hashchange")},setInterval(t,200)),!0}},e.History.construct())}(jQuery),$.History.extractHash=function(e){return e.replace(/^[^#!\/]*#/,"").replace(/^#+|#+$/,"")},$((function(){$.History.bind((function(e){var t="#"+e.substring(2);$(".rbx-tab a").each((function(){$(this).attr("href")==t&&$(this).click()}))}));$(".rbx-tab").click((function(e){if(e.hasOwnProperty("originalEvent")){var t="!/"+$(this).find("a").attr("href").substring(1);$.History.go(t)}}))})),(Roblox=Roblox||{}).AdsHelper=Roblox.AdsHelper||{},Roblox.AdsLibrary={},Roblox.AdsLibrary.adsIdList=["Skyscraper-Abp-Left","Skyscraper-Abp-Right","Leaderboard-Abp","GamePageAdDiv1","GamePageAdDiv2","GamePageAdDiv3","ProfilePageAdDiv1","ProfilePageAdDiv2"],Roblox.AdsLibrary.adsParameters={"Skyscraper-Abp-Left":{element:$("#Skyscraper-Abp-Left"),template:null,fitTwoAds:!0,fitOneAd:!1,isSkyscraper:!0},"Skyscraper-Abp-Right":{element:$("#Skyscraper-Abp-Right"),tempalte:null,fitTwoAds:!0,fitOneAd:!0,isSkyscraper:!0},"Leaderboard-Abp":{element:$("#Leaderboard-Abp"),tempalte:null,fitTwoAds:!0,fitOneAd:!0,isLeaderboard:!0},GamePageAdDiv1:{element:$("#GamePageAdDiv1"),template:null,isPageAd:!0},GamePageAdDiv2:{element:$("#GamePageAdDiv2"),template:null,isPageAd:!0},GamePageAdDiv3:{element:$("#GamePageAdDiv3"),template:null,isPageAd:!0},ProfilePageAdDiv1:{element:$("#ProfilePageAdDiv1"),template:null,isPageAd:!0},ProfilePageAdDiv2:{element:$("#ProfilePageAdDiv2"),template:null,isPageAd:!0}},Roblox.AdsHelper.AdRefresher=function(){function e(n){var a,s,l,c;for(s in void 0===n&&(n=i),a=!1,o){if(l="#"+o[s]+" [data-js-adtype]",void 0===(c=$(l)))return;if("iframead"===c.attr("data-js-adtype"))t(c);else if("gptAd"===c.attr("data-js-adtype"))if(googletag.pubadsReady)a=!0;else if(n>0){setTimeout((function(){e(--n)}),r);break}}a&&googletag.cmd.push((function(){googletag.pubads().refresh()}))}function t(e){var t,n,o,a=e.attr("src");"string"==typeof a&&(t=a.indexOf("?")<0?"?":"&",n=a+t+"nocache="+(new Date).getMilliseconds().toString(),void 0!==e[0])&&(void 0===(o=e[0].contentDocument)&&(o=e[0].contentWindow),o&&"about:blank"!==o.location.href&&o.location.replace(n))}function n(t,n,o){o.length&&function(e){return!e||!$.trim($(e).html())}(o)&&(o.append(t),e())}var o=[],a=728,r=100,i=16,s=$("[data-max-width-for-two-ads]").attr("data-max-width-for-two-ads")||1318,l=$("[data-max-width-for-one-ads]").attr("data-max-width-for-one-ads")||1134,c=1004;return{registerAd:function(e){o.push(e)},refreshAds:e,adjustAdsFitScreen:function(){for(var e,t,o,r=$(window).width(),i=0;i<Roblox.AdsLibrary.adsIdList.length;i++)t=Roblox.AdsLibrary.adsIdList[i],(o=Roblox.AdsLibrary.adsParameters[t])&&!o.template&&(e=o.element,o.template=e.html());for(i=0;i<Roblox.AdsLibrary.adsIdList.length;i++)t=Roblox.AdsLibrary.adsIdList[i],(o=Roblox.AdsLibrary.adsParameters[t])&&(o.isSkyscraper?r>=s&&o.fitTwoAds||r<s&&r>=l&&o.fitOneAd?n(o.template,0,o.element):o.element.empty():o.isLeaderboard?r<a?o.element.empty():n(o.template,0,o.element):o.isPageAd&&(r<c?o.element.empty():n(o.template,0,o.element)))},getAds:n}}(),Roblox.AdsHelper.DynamicAdCreator={populateNewAds:function(){$(".dynamic-ad").filter(".unpopulated").each((function(e,t){var n=$(t),o=n.attr("data-ad-slot"),a=parseInt(n.attr("data-ad-width")),r=parseInt(n.attr("data-ad-height")),i=n.children(".ad-slot").attr("id");googletag.cmd.push((function(){var e=googletag.defineSlot(o,[a,r],i).addService(googletag.pubads());googletag.display(i),googletag.pubads().refresh([e])})),n.removeClass("unpopulated")}))}},$((function(){$(window).resize((function(){Roblox.AdsHelper.AdRefresher.adjustAdsFitScreen()}))}));var isInitialized=!1,fitStringSpan=null;(Roblox=Roblox||{}).Voting=function(){var e=function(){var e,n,o=$(".voting-panel");0!==o.length&&($(".users-vote .upvote").unbind().click((function(){t($(this),!0)})),$(".users-vote .downvote").unbind().click((function(){t($(this),!1)})),e=parseInt(o.data("total-up-votes")),n=parseInt(o.data("total-down-votes")),r(e,n))},t=function(e,t){if($(".voting-panel").data("user-authenticated")){var o="/voting/vote?assetId="+$(".voting-panel").data("target-id")+"&vote=",a=$(".voting-panel").data("vote-url");a&&(o=a),e.hasClass("selected")||e.find("i").hasClass("selected")||e.find(".icon-like, .icon-dislike").hasClass("selected")?n(o,null):n(o,t)}else s("GuestUser")},n=function(e,t){$(".voting-panel .loading").show(),$.ajax({type:"POST",url:e+t,success:o,error:a})},o=function(e){var t=$(".icon-like").length;if($(".voting-panel .loading").hide(),e.Success){i(e.Model.UpVotes,e.Model.DownVotes);var n=$(".voting-panel .upvote"),o=$(".voting-panel .downvote"),a=$(".users-vote");t&&(n=$(".voting-panel .upvote .icon-like"),o=$(".voting-panel .downvote .icon-dislike")),null!==e.Model.UserVote?a.hasClass("has-voted")||a.addClass("has-voted"):a.removeClass("has-voted"),n.hasClass("selected")&&n.removeClass("selected"),o.hasClass("selected")&&o.removeClass("selected"),null!==e.Model.UserVote&&(e.Model.UserVote?n.addClass("selected"):o.addClass("selected")),r(e.Model.UpVotes,e.Model.DownVotes)}else s(e.ModalType)},a=function(){$(".voting-panel .loading").hide()},r=function(e,t,n){var o,a,r,i=n||$("#voting-section");isNaN(e)||isNaN(t)||((o=0===e?0:0===t?100:Math.floor(e/(e+t)*100))>100&&(o=100),r=(a=i.find(".vote-container")).find(".vote-background"),a.find(".vote-percentage").css("width",o+"%"),t>0?r.addClass("has-votes"):r.removeClass("has-votes"))},i=function(e,t){e=Roblox.NumberFormatting.abbreviatedFormat(e),t=Roblox.NumberFormatting.abbreviatedFormat(t),$(".voting-panel .total-upvotes-text").text(e),$(".voting-panel .total-downvotes-text").text(t),$(".voting-panel #vote-up-text").text(e),$(".voting-panel #vote-down-text").text(t),r(e,t)},s=function(e){e&&Roblox.Dialog.open(function(e){var t=Roblox.Lang.VotingPanelResources,n=Roblox.Intl&&t&&new Roblox.Intl,o=$("#voting-section"),a=o.data("accountPageUrl"),r=o.data("registerUrl"),i="<a href='"+a+"'>"+t["Label.AccountPageTitle"]+"</a>",s="<a href='"+r+"'>"+t["Label.LoginOrRegisterPageTitle"]+"</a>",l={EmailIsVerified:{titleText:t["Label.EmailVerifiedTitle"],bodyContent:n.f(t["Label.EmailVerifiedMessage"],{accountPageLink:i}),onAccept:function(){window.location.href=a},acceptColor:Roblox.Dialog.green,acceptText:t["Label.Accept"],declineText:t["Label.Decline"],allowHtmlContentInBody:!0},PlayGame:{titleText:t["Label.PlayGameTitle"],bodyContent:t["Label.PlayGameMessage"],showAccept:!1,declineText:t["Label.Ok"]},UseModel:{titleText:t["Label.UseModelTitle"],bodyContent:t["Label.UseModelMessage"],showAccept:!1,declineText:t["Label.Ok"]},InstallPlugin:{titleText:t["Label.InstallPluginTitle"],bodyContent:t["Label.InstallPluginMessage"],showAccept:!1,declineText:t["Label.Ok"]},BuyGamePass:{titleText:t["Label.BuyGamePassTitle"],bodyContent:t["Label.BuyGamePassMessage"],showAccept:!1,declineText:t["Label.Ok"]},FloodCheckThresholdMet:{titleText:t["Label.FloodCheckTitle"],bodyContent:t["Label.FloodCheckMessage"],showAccept:!1,declineText:t["Label.Ok"]},GuestUser:{titleText:t["Label.GuestUserTitle"],bodyContent:"<div>"+t["Label.YouMustLoginToVote"]+"</div><div>"+n.f(t["Label.GuestUserMessage"],{loginOrRegisterPageLink:s})+"</div>",onAccept:function(){window.location.href=r},acceptColor:Roblox.Dialog.green,acceptText:t["Label.Login"],declineText:t["Label.Decline"],allowHtmlContentInBody:!0},Error:{titleText:t["Label.UnknownProblemTitle"],bodyContent:t["Label.UnknownProblemMessage"],showAccept:!1,declineText:t["Label.Ok"]},AssetNotVoteable:{titleText:t["Label.AssetNotVoteableTitle"],bodyContent:t["Label.AssetNotVoteableMessage"],showAccept:!1,declineText:t["Label.Ok"]}};return l[e]||l.Error}(e))};return{Vote:n,Initialize:e,SetVotes:i,UpdateVoteBar:r,LoadVotingService:function(t,n){var o="/games/votingservice/"+n;$.ajax({url:o,success:function(n){t.replaceWith(n),$((function(){e()}))}})}}}(),$((function(){Roblox.Voting.Initialize()}));var Roblox=Roblox||{};$((function(){$("[data-voting-processed=false]").each((function(e,t){var n=$(t),o=n.find(".vote-container"),a=parseInt(o.attr("data-upvotes")),r=parseInt(o.attr("data-downvotes"));Roblox.Voting.UpdateVoteBar(a,r,n),n.attr("data-voting-processed",!0)}))}));Roblox=Roblox||{};var RobloxBadges=RobloxBadges||{};$((function(){if(void 0!==RobloxBadges.initRobloxBadgesFrameworkAgnostic)try{RobloxBadges.initRobloxBadgesFrameworkAgnostic()}catch(e){void 0!==Roblox.EventStream&&Roblox.EventStream.SendEvent("RobloxBadgesInitFailure","WebPlatformJsCaughtError",{})}}));var captcha=angular.module("captcha",[]);captcha.constant("captchaConstants",{template:"<div id='{{captchaElem.id}}' ng-show='captchaElem.isVisible'></div>",googleTemplate:"google-captcha-template",fcTemplate:"fun-captcha-template",fcModalTemplate:"fun-captcha-modal-template"}),captcha.directive("captcha",["$log","$parse","captchaConstants","captchaInterface",function(e,t,n,o){return{restrict:"A",template:n.template,link:function(n,a,r){function i(e,t,r,i){var l,c;a.find("#"+n.captchaElem.id);n.captchaElem.isVisible=!0,l=function(){(function(){var e=a.find("#"+n.captchaElem.id);e.empty(),n.captchaElem.isVisible=!1})(),angular.isFunction(t)&&t()},c=function(){angular.isFunction(r)&&r()},s?o.reset(e,l,c,i):(o.render(n.captchaElem.id,e,l,c,i),s=!0,o.execute())}var s,l,c;n.captchaElem={isVisible:!1},s=!1,l=t(r.captchaModel)(n),n.captchaElem.id=l.id||o.ids.defaultCaptcha,c=n.$watch((function(){return l.isActivated}),(function(o){if(o){var a=t(r.onCaptchaSuccess)(n)||angular.noop,s=t(r.onCaptchaError)(n)||angular.noop,c=t(r.onCaptchaResponse)(n)||angular.noop,d=t(r.captchaType)(n);if(!d)return void e.debug("[Captcha Error] captcha type cannot be empty");i(d,a,s,c),l.isActivated=!1}}),!0),n.$on("$destroy",(function(){c&&c()}))}}}]),captcha.factory("captchaInterface",["$q",function(){var e=Roblox.Captcha||{};return{types:e.types,ids:e.ids,setEndpoint:e.setEndpoint,setInvisibleMode:e.setInvisibleMode,setSiteKey:e.setSiteKey,reset:e.reset,render:e.render,execute:e.execute}}]),captcha.factory("funCaptchaInterface",["$q",function(){var e=Roblox.FunCaptcha||{};return{ids:Roblox.CaptchaConstants.ids,types:e.types,reset:e.reset,render:e.render}}]),captcha.directive("funCaptcha",["$log","$uibModal","captchaConstants","funCaptchaInterface",function(e,t,n,o){return{restrict:"A",scope:{captchaModel:"=",onFunCaptchaSuccess:"&",onFunCaptchaError:"&",onFunCaptchaSolved:"&",onFunCaptchaLoaded:"&",onFunCaptchaSuppress:"&",onFunCaptchaShown:"&",onFunCaptchaClosed:"&",captchaType:"=",credentialsValue:"=",credentialsType:"=",showInModal:"="},templateUrl:n.fcTemplate,link:function(a,r){function i(){a.showInModal&&(a.showContainer=!1,(l=t.open({templateUrl:n.fcModalTemplate,keyboard:!1,backdrop:"static"})).rendered.then((function(){c=angular.element("#funcaptcha-modal-body"),d=angular.element("#"+a.captchaElem.id).detach(),c.append(d),a.showContainer=!0})),l.result.then((function(){r.append(angular.element("#"+a.captchaElem.id).detach()),a.showContainer=!1,a.onFunCaptchaClosed&&a.onFunCaptchaClosed()}))),a.onFunCaptchaShown&&a.onFunCaptchaShown()}function s(){a.showInModal&&l&&l.close(),a.onFunCaptchaSolved&&a.onFunCaptchaSolved()}var l,c,d,u,f=a.captchaModel;a.captchaElem={id:f.id},a.showContainer=!0,u=a.$watch((function(){return f.isActivated}),(function(t){if(t){var n={successCb:a.onFunCaptchaSuccess||angular.noop,errorCb:function(e){a.onFunCaptchaError&&a.onFunCaptchaError({errorCode:e})},solvedCb:s,loadedCb:a.onFunCaptchaLoaded||angular.noop,suppressCb:a.onFunCaptchaSuppress||angular.noop,shownCb:i,cType:a.captchaType};if(!n.cType)return void e.debug("[Captcha Error] captcha type cannot be empty");f.extraValidationParams?n.extraValidationParams=f.extraValidationParams:a.credentialsValue&&a.credentialsType&&(n.extraValidationParams={credentialsValue:a.credentialsValue,credentialsType:a.credentialsType}),o.render(a.captchaElem.id,n),f.isActivated=!1}}),!0),a.$on("$destroy",(function(){u&&u()}))}}}]),void 0===Roblox&&(Roblox={}),void 0===Roblox.FormEvents&&(Roblox.FormEvents=function(){function e(e,t,n){Roblox.EventStream&&Roblox.EventStream.SendEvent(e,t,n)}return{SendValidationFailed:function(t,n,o,a){e("formValidation",t,{msg:a,input:o,field:n,vis:!0})},SendInteractionFocus:function(t,n){e("formInteraction",t,{aType:"focus",field:n})},SendInteractionOffFocus:function(t,n,o){var a={aType:"offFocus",field:n};o&&(a.input=o),e("formInteraction",t,a)},SendInteractionClick:function(t,n,o,a){var r={aType:"click",field:n};o&&(r.input=o),a&&(r=$.extend(r,a)),e("formInteraction",t,r)}}}());var formEvents=angular.module("roblox.formEvents",[]);formEvents.directive("rbxFormInteraction",(function(){return{require:"^form",restrict:"A",link:function(e,t,n,o){var a=n.sendInputValue;t.bind("blur",(function(){if(Roblox.FormEvents){var e,t=angular.element(this);a&&(e=t.val()),Roblox.FormEvents.SendInteractionOffFocus(o.context,t.attr("name"),e)}})).bind("focus",(function(){Roblox.FormEvents&&Roblox.FormEvents.SendInteractionFocus(o.context,angular.element(this).attr("name"))}))}}})),formEvents.directive("rbxFormContext",(function(){return{require:"form",restrict:"A",link:function(e,t,n,o){var a=o.$name;o.context=n.context+a.charAt(0).toUpperCase()+a.substr(1)}}})),robloxApp.constant("urlConstants",{urlQueryStringPrefix:"?",urlQueryParameterSeparator:"&",hashSign:"#"}),robloxApp.constant("phoneConstants",{templates:{verifyPhoneModal:"verify-phone-modal"},urls:{phonePrefixes:"/v1/countries/phone-prefix-list",addPhone:"/v1/phone",verifyPhone:"/v1/phone/verify",resendCode:"/v1/phone/resend"},modalTypes:{addPhone:"addPhone",verifyPhone:"verifyPhone"},minimumPhoneLength:4,underscore:"_",phonePrefixCharacter:"+",defaultCountryCode:"US",unitedStatesPrefix:{name:"United States",localizedName:"United States",code:"US",prefix:1}}),robloxApp.factory("phoneService",["$q","httpService","phoneConstants",function(e,t,n){var o=n.urls.phonePrefixes,a=n.defaultCountryCode;return{getPhonePrefixes:function(e){var n={url:e+o};return t.httpGet(n,null).then((function(e){var t;return _.reject(e,(function(e){return e.code===a&&(t=e,!0)})),t&&e.unshift(t),e}))},addPhone:function(e){var o={url:Roblox.EnvironmentUrls.accountInformationApi+n.urls.addPhoneV2},a={countryCode:e.countryCode,prefix:e.prefix,phone:e.phone,password:e.password};return t.httpPost(o,a)},verifyPhone:function(e){var o={url:Roblox.EnvironmentUrls.accountInformationApi+n.urls.verifyPhoneV2},a={code:e.code};return t.httpPost(o,a)},resendCode:function(){var e={url:Roblox.EnvironmentUrls.accountInformationApi+n.urls.resendCodeV2};return t.httpPost(e)},isPhoneNumber:function(e){return!(!e||e.length<n.minimumPhoneLength)&&(!!/\d/.test(e)&&/^[\d|\W|_]+$/.test(e))}}}]),void 0===Roblox&&(Roblox={}),void 0===Roblox.GenericConfirmation&&(Roblox.GenericConfirmation=function(){function e(e){e.hasClass(s)?e.addClass(d):e.hasClass(r)?e.addClass(l):e.hasClass(i)&&e.addClass(c)}function t(e){return!!(e.hasClass(c)||e.hasClass(d)||e.hasClass(l))}function n(e){p.isOpen=!1,void 0!==e?$.modal.close(e):$.modal.close()}function o(e){n(),"function"==typeof e&&e()}function a(e){if("function"==typeof e){var t=e();if("undefined"!==t&&0==t)return!1}n()}var r="btn-primary",i="btn-neutral",s="btn-negative",l="btn-disabled-primary",c="btn-disabled-neutral",d="btn-disabled-negative",u="#roblox-confirm-btn",f="#roblox-decline-btn",p={isOpen:!1},m={overlayClose:!0,escClose:!0,opacity:80,overlayCss:{backgroundColor:"#000"},onClose:function(){p.isOpen=!1,n()}};return{open:function(e){var n,r,l,c,d;p.isOpen=!0,n={titleText:"",bodyContent:"",footerText:"",acceptText:Roblox.Resources.GenericConfirmation.yes,declineText:Roblox.Resources.GenericConfirmation.No,acceptColor:i,declineColor:s,xToCancel:!1,onAccept:function(){return!1},onDecline:function(){return!1},onCancel:function(){return!1},imageUrl:null,allowHtmlContentInBody:!1,allowHtmlContentInFooter:!1,dismissable:!0,fieldValidationRequired:!1,onOpenCallback:function(){}},e=$.extend({},n,e),m.overlayClose=e.dismissable,m.escClose=e.dismissable,(r=$(u)).html(e.acceptText),r.attr("class","btn-large "+e.acceptColor),r.unbind(),r.bind("click",(function(){return t(r)||(e.fieldValidationRequired?a(e.onAccept):o(e.onAccept)),!1})),(l=$(f)).html(e.declineText),l.attr("class","btn-large "+e.declineColor),l.unbind(),l.bind("click",(function(){return t(l)||o(e.onDecline),!1})),$('[data-modal-handle="confirmation"] div.Title').text(e.titleText),c=$("[data-modal-handle='confirmation']"),null==e.imageUrl?c.addClass("noImage"):(c.find("img.GenericModalImage").attr("src",e.imageUrl),c.removeClass("noImage")),e.allowHtmlContentInBody?$("[data-modal-handle='confirmation'] div.Message").html(e.bodyContent):$("[data-modal-handle='confirmation'] div.Message").text(e.bodyContent),""==$.trim(e.footerText)?$('[data-modal-handle="confirmation"] div.ConfirmationModalFooter').hide():$('[data-modal-handle="confirmation"] div.ConfirmationModalFooter').show(),e.allowHtmlContentInFooter?$('[data-modal-handle="confirmation"] div.ConfirmationModalFooter').html(e.footerText):$('[data-modal-handle="confirmation"] div.ConfirmationModalFooter').text(e.footerText),$("[data-modal-handle='confirmation']").modal(m),(d=$("a.genericmodal-close")).unbind(),d.bind("click",(function(){return o(e.onCancel),!1})),e.xToCancel||d.hide(),e.onOpenCallback()},close:n,disableButtons:function(){var t=$(u),n=$(f);e(t),e(n)},enableButtons:function(){var e=$(u),t=$(f),n=c+" "+d+" "+l;e.removeClass(n),t.removeClass(n)},clickYes:function(){p.isOpen&&$(u).click()},clickNo:function(){$(f).click()},status:p,green:r,blue:i,gray:s,none:"btn-none"}}()),$(document).keypress((function(e){Roblox.GenericConfirmation.status.isOpen&&13===e.which&&Roblox.GenericConfirmation.clickYes()})),void 0===Roblox&&(Roblox={}),void 0===Roblox.Dialog&&(Roblox.Dialog=function(){function e(e){e.hasClass(l)?e.addClass(u):e.hasClass(i)?e.addClass(c):e.hasClass(s)&&e.addClass(d)}function t(e){return!!(e.hasClass(d)||e.hasClass(u)||e.hasClass(c))}function n(e){e.hasClass(u)?(e.removeClass(u),e.addClass(l)):e.hasClass(c)?(e.removeClass(c),e.addClass(i)):e.hasClass(d)&&(e.removeClass(d),e.addClass(s))}function o(e){g.isOpen=!1,void 0!==e?$.modal.close(e):$.modal.close(),$("#rbx-body").removeClass("modal-mask")}function a(e){o(),"function"==typeof e&&e()}var r=".simplemodal-container",i="btn-primary-md",s="btn-secondary-md",l="btn-control-md",c="btn-primary-md disabled",d="btn-secondary-md disabled",u="btn-control-md disabled",f=".modal-btns #confirm-btn",p=".modal-btns #decline-btn",m="#modal-checkbox-input",g={isOpen:!1},h={overlayClose:!0,escClose:!0,opacity:80,zIndex:1040,overlayCss:{backgroundColor:"#000"},onClose:o,focus:!1},b={Yes:"Yes",No:"No",Agree:"Agree"};return{open:function(i){var c,d,u,y,v,w;g.isOpen=!0,c={titleText:"",bodyContent:"",footerText:"",footerMiddleAligned:!1,acceptText:Roblox.Lang.ControlsResources["Action.Yes"]||b.Yes,declineText:Roblox.Lang.ControlsResources["Action.No"]||b.No,acceptColor:s,declineColor:l,xToCancel:!1,onAccept:function(){return!1},onDecline:function(){return!1},onCancel:function(){return!1},imageUrl:null,showAccept:!0,showDecline:!0,allowHtmlContentInBody:!1,allowHtmlContentInFooter:!1,dismissable:!0,fieldValidationRequired:!1,onOpenCallback:function(){},onCloseCallback:o,cssClass:null,checkboxAgreementText:Roblox.Lang.ControlsResources["Action.Agree"]||b.Agree,checkboxAgreementRequired:!1},i=$.extend({},c,i),h.overlayClose=i.dismissable,h.escClose=i.dismissable,i.onCloseCallback&&(h.onClose=function(){i.onCloseCallback(),o()}),(d=$(f)).html(i.acceptText),d.attr("class",i.acceptColor),d.unbind(),d.bind("click",(function(){return t(d)||(i.fieldValidationRequired?function(e){if("function"==typeof e){var t=e();if("undefined"!==t&&0==t)return!1}o()}(i.onAccept):a(i.onAccept)),!1})),(u=$(p)).html(i.declineText),u.attr("class",i.declineColor),u.unbind(),u.bind("click",(function(){return t(u)||a(i.onDecline),!1})),(y=$(m)).unbind(),y.bind("change",(function(){y.is(":checked")?n(d):e(d)})),(v=$('[data-modal-type="confirmation"]')).find(".modal-title").text(i.titleText),null==i.imageUrl?v.addClass("noImage"):(v.find("img.modal-thumb").attr("src",i.imageUrl),v.removeClass("noImage")),g.extraClass&&(v.removeClass(g.extraClass),g.extraClass=!1),null!=i.cssClass&&(v.addClass(i.cssClass),g.extraClass=i.cssClass),i.allowHtmlContentInBody?v.find(".modal-message").html(i.bodyContent):v.find(".modal-message").text(i.bodyContent),i.checkboxAgreementRequired?(e(d),v.find(".modal-checkbox.checkbox > input").prop("checked",!1),v.find(".modal-checkbox.checkbox > label").text(i.checkboxAgreementText),v.find(".modal-checkbox.checkbox").show()):(v.find(".modal-checkbox.checkbox > input").prop("checked",!0),v.find(".modal-checkbox.checkbox").hide()),""==$.trim(i.footerText)?v.find(".modal-footer").hide():v.find(".modal-footer").show(),i.allowHtmlContentInFooter?v.find(".modal-footer").html(i.footerText):v.find(".modal-footer").text(i.footerText),i.footerMiddleAligned&&v.find(".modal-footer").addClass("modal-footer-center"),v.modal(h),(w=$(r+" .modal-header .close")).unbind(),w.bind("click",(function(){return a(i.onCancel),!1})),i.xToCancel||w.hide(),i.showAccept||d.hide(),i.showDecline||u.hide(),$("#rbx-body").addClass("modal-mask"),i.onOpenCallback()},close:o,disableButtons:function(){var t=$(f),n=$(p);e(t),e(n)},enableButtons:function(){var e=$(f),t=$(p);n(e),n(t)},clickYes:function(){g.isOpen&&$(f).click()},clickNo:function(){$(p).click()},status:g,toggleProcessing:function(e,t){var n=$(".modal-body");e?(n.find(".modal-btns").hide(),n.find(".modal-processing").show()):(n.find(".modal-btns").show(),n.find(".modal-processing").hide()),void 0!==t&&""!==t&&$.modal.close("."+t)},green:i,blue:s,white:l,none:"btn-none"}}()),$(document).keypress((function(e){Roblox.Dialog.isOpen&&13===e.which&&Roblox.Dialog.clickYes()})),(Roblox=Roblox||{}).DeviceMeta=function(){var e=document.querySelector('meta[name="device-meta"]');if(null!==e){var t=e.dataset||{},n={android:"android",ios:"ios",xbox:"xbox",uwp:"uwp",amazon:"amazon",win32:"win32",universalapp:"universalApp",unknown:"unknown"},o={computer:"computer",tablet:"tablet",phone:"phone",console:"console"};return function(){return{deviceType:o[t.deviceType]||"",appType:n[t.appType]||"",isInApp:"true"===t.isInApp,isDesktop:"true"===t.isDesktop,isPhone:"true"===t.isPhone,isTablet:"true"===t.isTablet,isConsole:"true"===t.isConsole,isAndroidApp:"true"===t.isAndroidApp,isIosApp:"true"===t.isIosApp,isUWPApp:"true"===t.isUwpApp,isXboxApp:"true"===t.isXboxApp,isAmazonApp:"true"===t.isAmazonApp,isWin32App:"true"===t.isWin32App,isStudio:"true"===t.isStudio,isIosDevice:"true"===t.isIosDevice,isAndroidDevice:"true"===t.isAndroidDevice,isUniversalApp:"true"===t.isUniversalApp}}}console.debug("Error loading device information from meta tag - please check if meta tag is present")}(),Roblox&&Roblox.BundleDetector&&Roblox.BundleDetector.bundleDetected("page");